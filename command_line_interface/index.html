<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.61">
    <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/5408110.js"></script><script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5MC2SNS');
    </script><script>
              (function() {
                // Trigger the scroll event without actually scrolling
                function triggerScrollEvent() {
                  const targetElement = window;
                  const scrollEvent = new Event('scroll', {
                    bubbles: true,
                    cancelable: true,
                  });
                  targetElement.dispatchEvent(scrollEvent);
                }
        
                // Call the triggerScrollEvent and scrollBodyDown functions after the page is fully loaded
                window.addEventListener('load', () => {
                  triggerScrollEvent();
                });
              })();
            </script><title>Command-line Interface (CLI)</title><meta name="description" content="">
    <link rel="preload" href="/assets/style-e2ab0d9e.css" as="style"><link rel="stylesheet" href="/assets/style-e2ab0d9e.css">
    <link rel="modulepreload" href="/assets/app-ab3f7917.js"><link rel="modulepreload" href="/assets/framework-2a53fa2c.js"><link rel="modulepreload" href="/assets/index.html-6775caac.js"><link rel="modulepreload" href="/assets/index.html-1ff1fe72.js"><link rel="prefetch" href="/assets/index.html-e8171bcc.js" as="script"><link rel="prefetch" href="/assets/index.html-f1592cd8.js" as="script"><link rel="prefetch" href="/assets/index.html-dec3e580.js" as="script"><link rel="prefetch" href="/assets/index.html-39a3888c.js" as="script"><link rel="prefetch" href="/assets/index.html-e985a833.js" as="script"><link rel="prefetch" href="/assets/index.html-ca0acaa9.js" as="script"><link rel="prefetch" href="/assets/index.html-6c0a6077.js" as="script"><link rel="prefetch" href="/assets/index.html-0e9e4b3a.js" as="script"><link rel="prefetch" href="/assets/index.html-12858481.js" as="script"><link rel="prefetch" href="/assets/index.html-0247529f.js" as="script"><link rel="prefetch" href="/assets/index.html-21267412.js" as="script"><link rel="prefetch" href="/assets/index.html-4acf38da.js" as="script"><link rel="prefetch" href="/assets/index.html-f28801e4.js" as="script"><link rel="prefetch" href="/assets/index.html-d286dbf1.js" as="script"><link rel="prefetch" href="/assets/index.html-22cab04e.js" as="script"><link rel="prefetch" href="/assets/index.html-b8233d3a.js" as="script"><link rel="prefetch" href="/assets/index.html-31beec6a.js" as="script"><link rel="prefetch" href="/assets/index.html-1ee5676e.js" as="script"><link rel="prefetch" href="/assets/index.html-f83fc907.js" as="script"><link rel="prefetch" href="/assets/index.html-ebfc3abb.js" as="script"><link rel="prefetch" href="/assets/whmcs_saved.html-e44574f5.js" as="script"><link rel="prefetch" href="/assets/index.html-7e64b6d9.js" as="script"><link rel="prefetch" href="/assets/index.html-c201377f.js" as="script"><link rel="prefetch" href="/assets/index.html-3ec87d31.js" as="script"><link rel="prefetch" href="/assets/index.html-87f416f5.js" as="script"><link rel="prefetch" href="/assets/index.html-a8ce4f49.js" as="script"><link rel="prefetch" href="/assets/index.html-6d1480c5.js" as="script"><link rel="prefetch" href="/assets/index.html-1fc8e0bd.js" as="script"><link rel="prefetch" href="/assets/index.html-23985833.js" as="script"><link rel="prefetch" href="/assets/index.html-8ba2d8d8.js" as="script"><link rel="prefetch" href="/assets/index.html-7f5598c8.js" as="script"><link rel="prefetch" href="/assets/index.html-233045da.js" as="script"><link rel="prefetch" href="/assets/index.html-fe10d519.js" as="script"><link rel="prefetch" href="/assets/index.html-95490bb8.js" as="script"><link rel="prefetch" href="/assets/404.html-e0575d4e.js" as="script"><link rel="prefetch" href="/assets/index.html-c77d3478.js" as="script"><link rel="prefetch" href="/assets/index.html-69842f78.js" as="script"><link rel="prefetch" href="/assets/index.html-70b55a4d.js" as="script"><link rel="prefetch" href="/assets/index.html-aa1b1763.js" as="script"><link rel="prefetch" href="/assets/index.html-ded88bcc.js" as="script"><link rel="prefetch" href="/assets/index.html-272d184f.js" as="script"><link rel="prefetch" href="/assets/index.html-c91ecd0f.js" as="script"><link rel="prefetch" href="/assets/index.html-57400b04.js" as="script"><link rel="prefetch" href="/assets/index.html-b6c454ee.js" as="script"><link rel="prefetch" href="/assets/index.html-79e119a5.js" as="script"><link rel="prefetch" href="/assets/index.html-a3ed41f7.js" as="script"><link rel="prefetch" href="/assets/index.html-c6db6ad8.js" as="script"><link rel="prefetch" href="/assets/index.html-e3f6c99c.js" as="script"><link rel="prefetch" href="/assets/index.html-6016053c.js" as="script"><link rel="prefetch" href="/assets/index.html-bf4ce84b.js" as="script"><link rel="prefetch" href="/assets/index.html-7dbbc284.js" as="script"><link rel="prefetch" href="/assets/index.html-7e8d7d55.js" as="script"><link rel="prefetch" href="/assets/index.html-148e9470.js" as="script"><link rel="prefetch" href="/assets/index.html-dc467a22.js" as="script"><link rel="prefetch" href="/assets/index.html-becb3b82.js" as="script"><link rel="prefetch" href="/assets/whmcs_saved.html-628478ef.js" as="script"><link rel="prefetch" href="/assets/index.html-d5f8d5ab.js" as="script"><link rel="prefetch" href="/assets/index.html-18db7919.js" as="script"><link rel="prefetch" href="/assets/index.html-8b265a10.js" as="script"><link rel="prefetch" href="/assets/index.html-2fccd2d9.js" as="script"><link rel="prefetch" href="/assets/index.html-167297b1.js" as="script"><link rel="prefetch" href="/assets/index.html-6c4bcab2.js" as="script"><link rel="prefetch" href="/assets/index.html-2257af0e.js" as="script"><link rel="prefetch" href="/assets/index.html-bca1c21f.js" as="script"><link rel="prefetch" href="/assets/index.html-4295e33e.js" as="script"><link rel="prefetch" href="/assets/index.html-c68cff10.js" as="script"><link rel="prefetch" href="/assets/index.html-b37a2483.js" as="script"><link rel="prefetch" href="/assets/index.html-bbd33090.js" as="script"><link rel="prefetch" href="/assets/index.html-e0a6ac83.js" as="script"><link rel="prefetch" href="/assets/404.html-5aae01cb.js" as="script"><link rel="prefetch" href="/assets/docsearch.min-24f13224.js" as="script"><link rel="prefetch" href="/assets/docsearch.min-49eb4b49.js" as="script"><link rel="prefetch" href="/assets/vue-bot-ui.common-f4b80701.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar fixed"><div class="navbar-header"><div class="navbar-header__logo-wrapper"><a href="/" class="home-link"><img class="logo" src="/global/logo.svg" alt="logo header"></a><div class="header-layout__search-container header-mobile__hidden"><!----><form id="search-form" class="drawer-header__input"><input value="" id="algolia-search-input" placeholder="Search" class="header-layout__search-default"><div class="header-layout__search-icon-default"><img alt="search icon" src="/global/search.svg"></div></form><div><div class="drawer"><div class="drawer-header"><div class="drawer-header__wrapper"><h2 class="drawer-header__paragraph">How can we help you?</h2><div id="drawerSearch"></div></div><div class="drawer-cross"><img class="drawer-cross__img" src="/global/cross.svg" alt="cross"><p class="drawer-cross__text">close</p></div></div><div class="drawer-tabs__wrapper" data-v-c60e280a><!--[--><!--]--></div><main><div class="drawer-main"><div class="drawer-main__wrapper"><div class="drawer-main__breadcrumb"><!----></div><!--[--><!----><div style="--18dc7fb0:15;"><p class="no_results">What are you searching for?</p></div><!--]--></div></div><!----></main></div><!----></div></div></div><div class="links" style="max-width:nullpx;"><img class="navbar-header__mobile-search" src="/global/search.svg" alt="icon image"><div class="header-products-wrapper"><div class="dropdown"><!----><!----><div class="header-products-container"><img class="header-products-container__img" alt="hamburger menu" src="/global/hamburger-menu.svg"><p class="header-products-wrapper-paragraph">Products</p><img class="products-icon__default" width="10" height="8" src="/arrows/arrow-down.svg" alt="arrow down icon"></div></div></div><!--[--><a target="_blank" class="btn">Ask GPT?</a><a href="https://www.imunify360.com/support-portal/" target="_blank" class="btn">Submit support request</a><a href="https://trial4.imunify360.com/" target="_blank" class="btn btn-white">Try Free</a><!--]--></div></div><!----></header><!----><div class="page"><!--[--><!--]--><div class="breadcrumb-wrapper page-breadcrumb" data-v-9445381a><span class="breadcrumb-title" data-v-9445381a>Documentation:</span><!--[--><a aria-current="page" href="/command_line_interface/" class="router-link-active router-link-exact-active breadcrumb" data-v-9445381a>Command-line Interface (CLI)</a><!--]--></div><img class="page-mobile__sidebar-menu" src="/global/sidebar-menu.svg" alt="sidebar hamburger menu"><div class="page-nav-wrapper"><!----></div><div class="content" custom="false"><h1 id="command-line-interface-cli" tabindex="-1"><a class="header-anchor" href="#command-line-interface-cli" aria-hidden="true">#</a> Command-line Interface (CLI)</h1><h4 id="description" tabindex="-1"><a class="header-anchor" href="#description" aria-hidden="true">#</a> Description</h4><p>Imunify360 command-line interface (CLI) makes working with Imunify360 basics and features from your terminal even simpler.</p><h4 id="usage" tabindex="-1"><a class="header-anchor" href="#usage" aria-hidden="true">#</a> Usage</h4><p>For access to Imunify360 agent features from command-line interface (CLI), use the following command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>Basic usage:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent [command] [--option1] [--option2]...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><h4 id="options" tabindex="-1"><a class="header-anchor" href="#options" aria-hidden="true">#</a> Options</h4><p>The following options are available for all commands.</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--console-log-level [ERROR,WARNING,INFO,DEBUG]</code></span></td><td>Level of logging input to the console</td></tr><tr><td><span class="notranslate"><code>-h</code>, <code>--help</code></span></td><td>Returns the help message</td></tr><tr><td><span class="notranslate"><code>--json</code></span></td><td>Returns data in JSON format</td></tr><tr><td><span class="notranslate"><code>-v</code>, <code>--verbose</code></span></td><td>Allows to return data in good-looking view if the<span class="notranslate"><code>--json</code></span> option is used.</td></tr></tbody></table><h4 id="examples" tabindex="-1"><a class="header-anchor" href="#examples" aria-hidden="true">#</a> Examples</h4><ol><li><p>This command returns help message for the <span class="notranslate"><code>3rdparty</code></span> command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent 3rdparty -h
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div></li><li><p>This command returns data in JSON format in a good-looking view for the <span class="notranslate"><code>get</code></span> command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent get --period 1h --by-country-code UA --by-list black --json --verbose
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div></li></ol><p>Available commands:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><a aria-current="page" href="/command_line_interface/#_3rdparty" class="router-link-active router-link-exact-active"><span class="notranslate"><code>3rdparty</code></span></a></td><td>Make Imunify360 the primary IDS</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#backup-systems" class="router-link-active router-link-exact-active"><span class="notranslate"><code>backup-systems</code></span></a></td><td>Allows to manage backup systems integrated to Imunify360</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#blocked-ports" class="router-link-active router-link-exact-active"><span class="notranslate"><code>blocked-port</code></span></a></td><td>Return/Edit list of blocked ports</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#blocked-port-ip" class="router-link-active router-link-exact-active"><span class="notranslate"><code>blocked-port-ip</code></span></a></td><td>Allows to change the list of IPs that are excluded (allowed) for a certain blocked port</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#checkdb" class="router-link-active router-link-exact-active"><span class="notranslate"><code>checkdb</code></span></a></td><td>Check database integrity</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#check-domains" class="router-link-active router-link-exact-active"><span class="notranslate"><code>check-domains</code></span></a></td><td>Send domain list check</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#check-modsec-directives" class="router-link-active router-link-exact-active"><span class="notranslate"><code>check modsec directives</code></span></a></td><td>Allows to check whether the global ModSecurity<br>directives have values recommended by Imunify360</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#clean" class="router-link-active router-link-exact-active"><span class="notranslate"><code>clean</code></span></a></td><td>Clean the incidents</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#config" class="router-link-active router-link-exact-active"><span class="notranslate"><code>config</code></span></a></td><td>Allows to update and show configuration file via CLI</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#doctor" class="router-link-active router-link-exact-active"><span class="notranslate"><code>doctor</code></span></a></td><td>Collect info about system and send it to the Imunify support team</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#eula" class="router-link-active router-link-exact-active"><span class="notranslate"><code>eula</code></span></a></td><td>Allows to show and accept the end-user license agreement to automate installation</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#features" class="router-link-active router-link-exact-active"><span class="notranslate"><code>features</code></span></a></td><td>Manage available features for Imunify360</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#feature-management" class="router-link-active router-link-exact-active"><span class="notranslate"><code>feature-management</code></span></a></td><td>Manage Imunify360 features available for users</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#fix-modsec-directives" class="router-link-active router-link-exact-active"><span class="notranslate"><code>fix modsec directives</code></span></a></td><td>Fixes the non-recommended values (sets them to ones<br>recommended by Imunify360)</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#get" class="router-link-active router-link-exact-active"><span class="notranslate"><code>get</code></span></a></td><td>Returns list of incidents</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#hooks" class="router-link-active router-link-exact-active"><span class="notranslate"><code>hooks</code></span></a></td><td>Hooks-related commands</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#import" class="router-link-active router-link-exact-active"><span class="notranslate"><code>import</code></span></a></td><td>Import data</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#infected-domains" class="router-link-active router-link-exact-active"><span class="notranslate"><code>infected-domains</code></span></a></td><td>Returns infected domain list</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#ip-list" class="router-link-active router-link-exact-active"><span class="notranslate"><code>ip-list</code></span></a></td><td>To view or manage actual IPs within the local firewall lists (white/gray/blacklist)</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#login" class="router-link-active router-link-exact-active"><span class="notranslate"><code>login</code></span></a></td><td>Allows to get a token which can be used for authentication in <a href="/stand_alone/" class="">stand-alone Imunify UI</a>.</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#malware" class="router-link-active router-link-exact-active"><span class="notranslate"><code>malware</code></span></a></td><td>Allows to manage malware options</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#notifications-config" class="router-link-active router-link-exact-active"><span class="notranslate"><code>notifications-config</code></span></a></td><td>Allows to show and update notifications in the configuration file via CLI</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#proactive" class="router-link-active router-link-exact-active"><span class="notranslate"><code>proactive</code></span></a></td><td>Allows to manage Proactive Defense feature</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#register" class="router-link-active router-link-exact-active"><span class="notranslate"><code>register</code></span></a></td><td>Agent registration</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#reload-lists" class="router-link-active router-link-exact-active"><span class="notranslate"><code>reload-lists</code></span></a></td><td>Allows to use external files with the list of Black/White-listed IPs. <a href="/features/#external-black-whitelist-management" class="">More details</a>.</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#remote-proxy" class="router-link-active router-link-exact-active"><span class="notranslate"><code>remote-proxy</code></span></a></td><td>Allows to add an additional proxy subnet</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#rstatus" class="router-link-active router-link-exact-active"><span class="notranslate"><code>rstatus</code></span></a></td><td>Query the server to check if the license is valid</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#rules" class="router-link-active router-link-exact-active"><span class="notranslate"><code>rules</code></span></a></td><td>Allows user to manage disabled rules</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#submit-false-positive-false-negative" class="router-link-active router-link-exact-active"><span class="notranslate"><code>submit false-positive/false-negative</code></span></a></td><td>Allows to submit a file as false positive/false negative</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#unregister" class="router-link-active router-link-exact-active"><span class="notranslate"><code>unregister</code></span></a></td><td>Unregister the agent</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#vendors" class="router-link-active router-link-exact-active"><span class="notranslate"><code>vendors</code></span></a></td><td>Command for manipulating Imunify360 vendors</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#version" class="router-link-active router-link-exact-active"><span class="notranslate"><code>version</code></span></a></td><td>Show version</td></tr><tr><td><a aria-current="page" href="/command_line_interface/#whitelisted-crawlers" class="router-link-active router-link-exact-active"><span class="notranslate"><code>whitelisted-crawlers</code></span></a></td><td>Allows do operate with search engine domains</td></tr></tbody></table><p>Optional arguments for the commands:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--by-country-code [country_code]</code></span></td><td>Filters output by country code.<br>Requires valid country code as argument.<br> Find valid country codes <a href="https://www.nationsonline.org/oneworld/country_code_list.htm" target="_blank" rel="noopener noreferrer">here</a> in column ISO ALPHA-2 CODE.</td></tr><tr><td><span class="notranslate"><code>--by-ip [ip_address]</code></span></td><td>Filters output by abuser&#39;s IP or by subnet in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#IPv4_CIDR_blocks" target="_blank" rel="noopener noreferrer">CIDR notation</a>.<br>Example: <span class="notranslate"><code>--by-ip 1.2.3.0/24</code></span>.</td></tr><tr><td><span class="notranslate"><code>--by-list</code></span></td><td>Can be:<br><ul><li><span class="notranslate">gray (Gray List)</span></li><li><span class="notranslate">white (White List)</span></li><li><span class="notranslate">black (Black List)</span></li></ul>Filters output based on the list type.<br>Example: <span class="notranslate"><code>--by-list black</code></span>.</td></tr><tr><td><span class="notranslate"><code>--by-comment</code></span></td><td>Filters output by comment.</td></tr><tr><td><span class="notranslate"><code>--limit</code></span></td><td>limits the output with specified number of incidents.<br>Must be a number greater than zero. By default, equals 100.</td></tr><tr><td><span class="notranslate"><code>--offset</code></span></td><td>Offset for pagination. By default, equals 0.</td></tr><tr><td><span class="notranslate"><code>--to</code></span></td><td>Allows to set the end of the period for filter.<br>Format is a timestamp.</td></tr><tr><td><span class="notranslate"><code>--manual</code></span></td><td>Show only items that have been added manually.</td></tr><tr><td><span class="notranslate"><code>--order-by</code></span></td><td>List of fields to sort the results by.</td></tr></tbody></table><h2 id="_3rdparty" tabindex="-1"><a class="header-anchor" href="#_3rdparty" aria-hidden="true">#</a> 3rdparty</h2><p>Command for disabling 3rd party IDS (currently they are cPHulk and fail2ban) and make Imunify360 agent the primary IDS.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent 3rdparty
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>command</code></span> is a positional argument and can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>conflicts</code></span></td><td>Show conflicts with other software</td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>List other IDS that might be running concurrently with Imunify360</td></tr></tbody></table><p><strong>Examples:</strong></p><ol><li>The following command shows if there are any conflicts with other software:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent 3rdparty conflicts
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol><li>The following command lists other IDS that might be running concurrently with Imunify360. Here is the example of the command and the output on the server with Fail2ban enabled:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent 3rdparty list
fail2ban
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="backup-systems" tabindex="-1"><a class="header-anchor" href="#backup-systems" aria-hidden="true">#</a> Backup systems</h2><p>Allows to manage backup systems integrated to Imunify360.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent backup-systems [command] &lt;value&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>command</code></span> is a positional argument and can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>list</code></span></td><td>List of all available backup systems.</td></tr><tr><td><span class="notranslate"><code>status</code></span></td><td>Returns backup system status including a current backup system and enabling status.</td></tr><tr><td><span class="notranslate"><code>extended-status</code></span></td><td>Returns extended status including log file path, error on executing, current backup system, enabling status, current state, and current backup progress bar.</td></tr><tr><td><span class="notranslate"><code>init</code></span></td><td><span class="notranslate"><code>&lt;value&gt;</code></span> must be in the list of available backup systems. Initializes <span class="notranslate"><code>&lt;value&gt;</code></span> backup system.</td></tr><tr><td><span class="notranslate"><code>disable</code></span></td><td>Disables backup system.</td></tr></tbody></table><p>The <span class="notranslate"><code>status</code></span> command returns <span class="notranslate"><code>{&#39;&lt;key&gt;&#39;: &lt;value&gt;}</code></span> (<span class="notranslate">JSON</span> formatted):</p><table><thead><tr><th>Key</th><th>Value</th></tr></thead><tbody><tr><td><span class="notranslate"><code>backup_system</code></span></td><td><span class="notranslate">Str</span> with the name of the currently enabled backup system.</td></tr><tr><td><span class="notranslate"><code>enabled</code></span></td><td>If backups are enabled — <span class="notranslate"><code>True</code></span>, else — <span class="notranslate"><code>False</code></span>.</td></tr></tbody></table><p>The <span class="notranslate"><code>extended-status</code></span> command returns <span class="notranslate"><code>{&#39;&lt;key&gt;&#39;: &lt;value&gt;}</code></span> (<span class="notranslate">JSON</span> formatted):</p><table><thead><tr><th>Key</th><th>Value</th></tr></thead><tbody><tr><td><span class="notranslate"><code>log_path</code></span></td><td><span class="notranslate">Str</span> with the path to the log file.</td></tr><tr><td><span class="notranslate"><code>error</code></span></td><td><span class="notranslate">Str</span> with a human-friendly error message.</td></tr><tr><td><span class="notranslate"><code>backup_system</code></span></td><td><span class="notranslate">Str</span> with the name of the currently enabled backup system.</td></tr><tr><td><span class="notranslate"><code>enabled</code></span></td><td>If backups are enabled — <span class="notranslate"><code>True</code></span>, else — <span class="notranslate"><code>False</code></span>.</td></tr><tr><td><span class="notranslate"><code>state</code></span></td><td><span class="notranslate">Str</span> with the current running condition. Statuses: <span class="notranslate"><code>not_running</code>, <code>init</code>, <code>backup</code>, <code>done</code>, <code>unpaid</code></span>.</td></tr><tr><td><span class="notranslate"><code>progress</code></span></td><td>This key is optional. It represents the progress of backup if it is running.</td></tr></tbody></table><p><strong>Examples:</strong></p><ol><li>The following command prints a list of all available backup systems:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent backup-systems list 
cpanel
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><ol start="2"><li>The following command initializes cPanel backup system:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent backup-systems init cpanel
Backup initialization process is in progress
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><ol start="3"><li>The following command checks if the cPanel backup system is connected:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent backup-systems status
{&#39;backup_system&#39;: &#39;cpanel&#39;, &#39;enabled&#39;: True}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="blocked-ports" tabindex="-1"><a class="header-anchor" href="#blocked-ports" aria-hidden="true">#</a> Blocked ports</h2><p>This command allows to view or edit ports, IPs, and protocols in the list of blocked ports.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Imunify360 can block particular ports using the <span class="notranslate"><code>blocked-port</code></span> command, yet it doesn&#39;t support a paradigm to &quot;block everything but the selected ports&quot;. That could be achieved via legacy Linux iptables.</p></div><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent blocked-port [command] &lt;value&gt; [--option]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>command</code></span> is a first positional argument and can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>add</code></span></td><td>add item(-s) to blocked ports</td></tr><tr><td><span class="notranslate"><code>delete</code></span></td><td>remove item(-s) from blocked ports</td></tr><tr><td><span class="notranslate"><code>edit</code></span></td><td>edit comment on item in the blocked ports</td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>list items(-s) in blocked ports</td></tr></tbody></table><p><span class="notranslate"><code>value</code></span> is an item to manipulate with. <span class="notranslate"><code>value</code></span> is <code>:</code> separated pair of port number and protocol: <code>5432:tcp</code>, <code>28:udp</code></p><p><span class="notranslate"><code>option</code></span> can be one or few of the optional arguments specified above and some more:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--comment</code></span></td><td>allows to add comment to the item</td></tr><tr><td><span class="notranslate"><code>--ips</code></span></td><td>block port for all IP addresses except the specified</td></tr></tbody></table><p><strong>Example:</strong></p><p>The following command blocks port 5555 for tcp connections with a comment <span class="notranslate">&quot;Some comment&quot;</span>:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent blocked-port add 5555:tcp --comment &quot;Some comment&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>This one includes the list of example IPs and ports blocked:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># imunify360-agent blocked-port list

COMMENT       ID  IPS                                                                                   PORT  PROTO
              1   []                                                                                    3306  tcp  
Some comment  2   [{&#39;comment&#39;: None, &#39;ip&#39;: &#39;111.111.111.111&#39;}, {&#39;comment&#39;: None, &#39;ip&#39;: &#39;22.22.22.22&#39;}]  5555  tcp 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="blocked-port-ip" tabindex="-1"><a class="header-anchor" href="#blocked-port-ip" aria-hidden="true">#</a> Blocked Port IP</h2><p>This command allows to change the list of IPs that are excluded (allowed) for a certain blocked port.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent blocked-port-ip [command] &lt;value&gt; [--option]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>command</code></span> is a first positional argument and can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>add</code></span></td><td>add IPs to blocked port</td></tr><tr><td><span class="notranslate"><code>delete</code></span></td><td>remove IPs from blocked port</td></tr><tr><td><span class="notranslate"><code>edit</code></span></td><td>edit comment on item in the blocked ports</td></tr></tbody></table><p><span class="notranslate"><code>value</code></span> is an IP address and blocked port.</p><p><span class="notranslate"><code>option</code></span> can be one or few of the optional arguments for all commands specified above and one more:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--comment</code></span></td><td>allows to add comment to the IP</td></tr></tbody></table><p><strong>Example:</strong></p><p>The following command blocks port tcp 5555 to all IPs except 12.34.56.78 with a comment <span class="notranslate">&#39;Some comment&#39;</span>:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent blocked-port-ip add 5555:tcp --ips 12.34.56.78 --comment &#39;Some comment&#39;
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="checkdb" tabindex="-1"><a class="header-anchor" href="#checkdb" aria-hidden="true">#</a> Checkdb</h2><p>Checks database integrity. In case database is corrupt, then this command saves backup copy of the database at the <span class="notranslate"><code>/var/imunify360</code></span> and tries to restore integrity of the original database. Note that if this command cannot restore database integrity, then it will destroy the original broken database.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent checkdb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><strong>Example:</strong></p><p>The following command checks the database integrity:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent checkdb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><h2 id="check-domains" tabindex="-1"><a class="header-anchor" href="#check-domains" aria-hidden="true">#</a> Check-domains</h2><p>Allows to send domains list for a check to the Imunify360 central server. After domains checked, the results is available via command <span class="notranslate"><code>infected-domains</code></span>.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p><span class="notranslate"><code>check-domains</code></span> command may take a few minutes to complete.</p></div><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent check-domains [--optional arguments]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><strong>Example:</strong></p><p>The following command sends the domains list for a check to the Imunify360 central server:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent check-domains
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="check-modsec-directives" tabindex="-1"><a class="header-anchor" href="#check-modsec-directives" aria-hidden="true">#</a> Check modsec directives</h2><p>Allows to check whether the global <a href="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v2.x%29#Configuration_Directives" target="_blank" rel="noopener noreferrer">ModSecurity directives</a> have values recommended by Imunify360.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent check modsec directives [--optional arguments]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><strong>Example:</strong></p><p>The following command checks whether the global ModSecurity directives have values recommended by Imunify360.</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent check modsec directives
WARNING: {&#39;ignored&#39;: False, &#39;id&#39;: &#39;1000&#39;, &#39;fix&#39;: &#39;Run `imunify360-agent fix modsec directives` command&#39;, &#39;title&#39;: &quot;Wrong value for SecConnEngine ModSecurity directive. Expected: &#39;Off&#39; Got: None&quot;, &#39;url&#39;: &#39;https://docs.imunify360.com/&#39;}
WARNING: {&#39;ignored&#39;: False, &#39;id&#39;: &#39;1000&#39;, &#39;fix&#39;: &#39;Run `imunify360-agent fix modsec directives` command&#39;, &#39;title&#39;: &quot;Wrong value for SecAuditEngine ModSecurity directive. Expected: &#39;RelevantOnly&#39; Got: None&quot;, &#39;url&#39;: &#39;https://docs.imunify360.com/&#39;}
WARNING: {&#39;ignored&#39;: False, &#39;id&#39;: &#39;1000&#39;, &#39;fix&#39;: &#39;Run `imunify360-agent fix modsec directives` command&#39;, &#39;title&#39;: &quot;Wrong value for SecRuleEngine ModSecurity directive. Expected: &#39;On&#39; Got: None&quot;, &#39;url&#39;: &#39;https://docs.imunify360.com/&#39;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="clean" tabindex="-1"><a class="header-anchor" href="#clean" aria-hidden="true">#</a> Clean</h2><p>Clean the incident list.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent clean [--optional arguments]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><strong>Optional arguments:</strong></p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--days</code></span></td><td>cleanups incidents from database, if there are more than specified days quantity<br>Example: <span class="notranslate"><code>--days 5</code></span>.<br>this option will cause deletion of all incidents that are older than 5 days from today</td></tr><tr><td><span class="notranslate"><code>--limit</code></span></td><td>leaves only limited number of the incidents in the database and deletes the others<br>Example: <span class="notranslate"><code>--limit 5000</code></span>.<br>this option will leave only 5000 new incidents and delete the others</td></tr></tbody></table><p><strong>Example:</strong></p><p>The following command deletes all incidents that are older than 5 days from today and leave only 5000 new incidents. The output identifies the number of the incidents cleaned.</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># imunify360-agent clean --days 5 --limit 5000
2521
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="config" tabindex="-1"><a class="header-anchor" href="#config" aria-hidden="true">#</a> Config</h2><p>Allows to update and show configuration file via CLI.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config [command] [configuration options]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>command</code></span> can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>show</code></span></td><td>show configuration file</td></tr><tr><td><span class="notranslate"><code>update</code></span></td><td>update configuration file</td></tr></tbody></table><p>You can find all configuration options <a href="/config_file_description/" class="">here</a> and instructions on how to apply configuration changes from CLI <a href="/config_file_description/#how-to-apply-changes-from-cli" class="">here</a>.</p><p><strong>Example:</strong></p><p>Set <span class="notranslate"><code>MALWARE_SCAN_INTENSITY.cpu = 5</code></span> configuration option from a command line:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;MALWARE_SCAN_INTENSITY&quot;: {&quot;cpu&quot;: 5}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>The successful output should display the configuration file content.</p><h2 id="doctor" tabindex="-1"><a class="header-anchor" href="#doctor" aria-hidden="true">#</a> Doctor</h2><p>Collecting information about Imunify360 state, generating the report and sending it to Imunify360 Support Team. This command can be used in case of any troubles or issues with Imunify360. This command will generate a key to be sent to Imunify360 Support Team. With that key Imunify360 Support Team can help with any problem as fast as possible.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent doctor
Please, provide this key:
SSXX11xXXXxxxxXX.1a1bcd1e-222f-33g3-hi44-5551k5lmn555
to Imunify360 Support Team
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="eula" tabindex="-1"><a class="header-anchor" href="#eula" aria-hidden="true">#</a> Eula</h2><p>Allows to show and accept the end-user license agreement to automate installation.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent eula [command]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>command</code></span> can be one of the following:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>accept</code></span></td><td>accept end-user license agreement</td></tr><tr><td><span class="notranslate"><code>show</code></span></td><td>show end-user license agreement</td></tr></tbody></table><p><strong>Example:</strong></p><p>Show the end-user license agreement:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent eula show
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><h2 id="features" tabindex="-1"><a class="header-anchor" href="#features" aria-hidden="true">#</a> Features</h2><p>Allows to enable or disable additional CloudLinux software included in Imunify360 for free. The following software is available:</p><ul><li><a href="https://www.kernelcare.com" target="_blank" rel="noopener noreferrer">KernelCare</a> – use <code>kernelcare</code> feature name</li><li><span class="notranslate"><a href="https://www.cloudlinux.com/hardenedphp" target="_blank" rel="noopener noreferrer">HardenedPHP</a></span> – use <span class="notranslate"><code>hardened-php</code></span> feature name</li></ul><div class="tip custom-block"><p class="custom-block-title">Note</p><p>You cannot install arbitrary 3rd party components or anything besides the features listed above. Please, use legacy linux package installation process for that</p></div><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent features [command] &lt;feature name&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>command</code></span> is a positional arguments and can be :</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>install</code></span></td><td>allows to enable software</td></tr><tr><td><span class="notranslate"><code>remove</code></span></td><td>allows to disable software</td></tr><tr><td><span class="notranslate"><code>status</code></span></td><td>allows to check the status of the software</td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>allows to list all available software</td></tr></tbody></table><p><strong>Examples:</strong></p><ol><li>The following command checks if KernelCare is installed:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent features status kernelcare
{&#39;status&#39;: &#39;not_installed&#39;, &#39;message&#39;: &#39;KernelCare is not installed&#39;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><ol start="2"><li>The following command installs KernelCare:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent features install kernelcare
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol start="3"><li>The following command uninstalls KernelCare:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent features remove kernelcare
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><h2 id="feature-management" tabindex="-1"><a class="header-anchor" href="#feature-management" aria-hidden="true">#</a> Feature-management</h2><p>Allows to manage Imunify360 features available for users.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent feature-management [command] [--optional argument]...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>Command</code></span> can be one of the following:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>defaults</code></span></td><td>show the default value for each feature that is applied for newly created user</td></tr><tr><td><span class="notranslate"><code>disable</code></span></td><td>disable a feature for some or all users</td></tr><tr><td><span class="notranslate"><code>enable</code></span></td><td>enable a feature for some or all users</td></tr><tr><td><span class="notranslate"><code>get</code></span></td><td>obtains the status of all available features for a <span class="notranslate"><code>USER</code></span></td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>list all available features</td></tr><tr><td><span class="notranslate"><code>native</code></span></td><td>allows to enable/disable the <span class="notranslate">Native Features Management</span> using WHM/cPanel package extensions</td></tr><tr><td><span class="notranslate"><code>show</code></span></td><td>allows to show enabled features</td></tr></tbody></table><p><span class="notranslate"><code>Optional argument</code></span> for the <span class="notranslate"><code>enable/disable</code></span> commands can be one of the following:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>[--feature av]</code></span></td><td>enable/disable <span class="notranslate">Malware Cleanup</span></td></tr><tr><td><span class="notranslate"><code>[--feature proactive]</code></span></td><td>enable/disable <span class="notranslate">Proactive Defense</span></td></tr><tr><td><span class="notranslate"><code>[--users [USERS [USERS ...]]]</code></span></td><td>specifies the list of users which will be affected, otherwise the default value will be changed</td></tr></tbody></table><p>The mandatory argument for the <span class="notranslate"><code>get</code></span> command:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>[--user USER]</code></span></td><td>specifies a user name to obtain the status of features for</td></tr></tbody></table><p>The mandatory argument for the <span class="notranslate"><code>native</code></span> command:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>disable</code></span></td><td>disable the <span class="notranslate">Native Features Management</span> using WHM/cPanel package extensions and return the original Imunify360 <span class="notranslate">Features Management</span> back</td></tr><tr><td><span class="notranslate"><code>enable</code></span></td><td>enable the <span class="notranslate">Native Features Management</span> using WHM/cPanel package extensions</td></tr></tbody></table><p><strong>Example:</strong></p><ol><li>The following command enables <span class="notranslate">Malware Cleanup</span> feature for the <span class="notranslate"><code>user1</code></span>:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent feature-management enable --feature av --users user1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol start="2"><li>The following command disables the <span class="notranslate">Native Features Management</span></li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent feature-management native disable
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>Once the command executed:</p><ul><li>The <span class="notranslate">Native Features Management</span> will be deactivated</li><li>The Imunify360 <span class="notranslate">Package Extensions</span> will be removed from all packages</li><li>The original Imunify360 <span class="notranslate">Features Management</span> will be activated</li></ul><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Imunify360 will keep applying users <span class="notranslate">Features Management</span> settings stored in their data bases after switching to the original Imunify360 <span class="notranslate">Features Management</span>.</p></div><div class="warning custom-block"><p class="custom-block-title">Warning</p><p><span class="notranslate"><code>feature-management enable/disable --feature av</code></span> and <span class="notranslate"><code>feature-management enable/disable --feature proactive</code></span> commands will start functioning.</p></div><ol><li>The following command enables the <span class="notranslate">Native Features Management</span></li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent feature-management native enable
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><p>Once the command executed, the following default Imunify360 <span class="notranslate">Package Extension</span> settings will be applied to all Packages:</p><ul><li><span class="notranslate">Malware Scanner - View Reports Only</span></li><li><span class="notranslate">Proactive Defense - Available</span></li></ul><p>Imunify360 <span class="notranslate">Package Extensions</span> will be auto-enabled for all packages disregarding the fact they have Imunify360 plugin enabled or not.</p><p>All existing <span class="notranslate">Features Management</span> settings will be overridden with the Imunify360 <span class="notranslate">Package Extensions</span> ones for all users.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p><span class="notranslate">Features Management</span> tab will be hidden on the User Interface.</p></div><div class="warning custom-block"><p class="custom-block-title">Warning</p><p><span class="notranslate"><code>feature-management enable/disable --feature av</code></span> and <span class="notranslate"><code>feature-management enable/disable --feature proactive</code></span> commands will stop functioning.</p></div><h2 id="fix-modsec-directives" tabindex="-1"><a class="header-anchor" href="#fix-modsec-directives" aria-hidden="true">#</a> Fix modsec directives</h2><p>Fixes the non-recommended values (sets them to ones recommended by Imunify360)</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent fix modsec directives [--optional arguments]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><strong>Example:</strong></p><p>The following command sets the ModSecurity directives values to ones recommended by Imunify360:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent fix modsec directives
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><p>If the execution was unsuccessful, the actual error message will be displayed if there are any issues with that.</p><h2 id="get" tabindex="-1"><a class="header-anchor" href="#get" aria-hidden="true">#</a> Get</h2><p>The command returns the lists of incidents.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent get [--required argument] [--optional argument]...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>Option can be one or few of the optional arguments listed above and one more.</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--order-by [ORDER_BY [ORDER_BY ...]]</code></span></td><td>Sorting order.</td></tr><tr><td><span class="notranslate"><code>--limit</code></span></td><td>Limits the output with specified number of IPs.<br>Must be a number greater than zero. By default, equals 50.</td></tr><tr><td><span class="notranslate"><code>--by-country-code [country_code]</code></span></td><td>Filters output by country code.<br>Requires valid country code as argument.<br>Find valid country codes<br>in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#IPv4_CIDR_blocks" target="_blank" rel="noopener noreferrer">CIDR notation</a> in column ISO ALPHA-2 CODE.</td></tr><tr><td><span class="notranslate"><code>--period [period]</code></span></td><td>Timeframe.<br>Allows to specify the amount of time starting from the current day.<br>Should be greater than (or equal to) 1 minute.<br>Can be specified in format:<ul><li><span class="notranslate"><code>&lt;int&gt;m</code></span> – minutes, example <span class="notranslate"><code> --period 30m</code></span></li><li><span class="notranslate"><code>&lt;int&gt;h</code></span> – hours, example <span class="notranslate"><code>--period 4h</code></span></li><li><span class="notranslate"><code>&lt;int&gt;d</code></span> – days, example <span class="notranslate"><code>--period 7d</code></span></li><li><span class="notranslate"><code>today</code></span> – for today, example <span class="notranslate"><code>--period today</code></span></li><li><span class="notranslate"><code>yesterday</code></span> – for yesterday, example <span class="notranslate"><code>--period yesterday</code></span></li></ul>For example, <span class="notranslate"><code> --period 5d</code></span> will return a list of incidents for 5 days.</td></tr><tr><td><span class="notranslate"><code>--since [timestamp]</code></span></td><td>allows to set start time to filter the list of incidents by period</td></tr><tr><td><span class="notranslate"><code>--to [timestamp]</code></span></td><td>allows to set finish time to filter the list of incidents by period</td></tr><tr><td><span class="notranslate"><code>--severity</code></span></td><td>allows to set severity to filter the list of incidents</td></tr><tr><td><span class="notranslate"><code>--offset OFFSET</code></span></td><td>offset for pagination. By default, equals 0</td></tr><tr><td><span class="notranslate"><code>--by-abuser-ip [BY_ABUSER_IP]</code></span></td><td>selection based on abuser IP address</td></tr><tr><td><span class="notranslate"><code>--json</code></span></td><td>return data in JSON format</td></tr><tr><td><span class="notranslate"><code>--search</code></span></td><td>string to search incidents by</td></tr><tr><td><span class="notranslate"><code>--by-list</code></span></td><td>Can be:<br><ul><li>any</li><li>gray (Gray List)</li><li>white (White List)</li><li>black (Black List)</li></ul>Filters output based on the list type.<br>Example: <span class="notranslate"><code>--by-list black</code></span>.</td></tr></tbody></table><p><em>Example:</em></p><p>The following command shows the incidents (in JSON format) for recent one hour, filtered by country code UA and filtered by Black List IPs:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent get --period 1h --by-country-code UA --by-list black --json
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>This one will show the incidents with the severity level 5 of triggered rules, e.g.:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># imunify360-agent get --period 20d --severity 5

TIMESTAMP   ABUSER        COUNTRY  TIMES    NAME                         SEVERITY
1600162404  11.22.33.44    CN        1      SSHD authentication failed.  5       
1600154599  11.22.33.44    CN        1      SSHD authentication failed.  5       
1600138163  11.22.33.44    CN        1      Process exiting (killed).    5 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>To get more detailed output to check the plugin or the rule ID these incidents belong to, use the <code>--json</code> argument.</p><h2 id="hooks" tabindex="-1"><a class="header-anchor" href="#hooks" aria-hidden="true">#</a> Hooks <!----></h2><div class="danger custom-block"><p class="custom-block-title">Warning</p><p>You can use a new notification system via <a aria-current="page" href="/command_line_interface/#notifications-config" class="router-link-active router-link-exact-active">CLI</a> and <a href="/features/#notifications" class="">UI</a>.</p></div><p>You can find more about hooks <a href="/features/#hooks" class="">here</a>.</p><p>This command allows managing hooks.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent hook [command] --event [event_name|all] [--path &lt;/path/to/hook_script&gt;]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>command</code></span> can be one of the following:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>add</code></span></td><td>register a new event handler</td></tr><tr><td><span class="notranslate"><code>delete</code></span></td><td>unregister existing event handler</td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>show existing event handlers</td></tr><tr><td><span class="notranslate"><code>add-native</code></span></td><td>register a new native event handler</td></tr></tbody></table><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--event [event_name|all]</code></span></td><td>defines a particular event that invokes<br>a registered handler as opposed to all keyword</td></tr><tr><td><span class="notranslate"><code>--path &lt;/path/to/hook_script&gt;</code></span></td><td>shall contain a valid path to a handler of the event,<br>it shall be any executable or Python Native event handlers<br>that agent will run upon a registered event</td></tr></tbody></table><p><strong>Example:</strong></p><p>The following command shows existing event handlers. If you have any hooks configured, the output will include something similar to this:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent hook list --event all
Event: malware-detected, Path: /root/directory/im360mwscannereventhooks/get_user.py
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="import" tabindex="-1"><a class="header-anchor" href="#import" aria-hidden="true">#</a> Import</h2><p>This command allows to import <span class="notranslate">Black List</span> and <span class="notranslate">White List</span> from the other 3rd party IDS (only CSF supported at the moment) to Imunify360 database. Note. If CSF is enabled, then it is not necessary to run the command because Imunify360 is integrated with CSF.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent import {blocked-ports, wblist} ...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><strong>Positional arguments:</strong></p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>blocked-ports</code></span></td><td>Import blocked-ports from other IDS</td></tr><tr><td><span class="notranslate"><code>wblist</code></span></td><td>Import <span class="notranslate">White/Black List</span> from other IDS</td></tr></tbody></table><p><strong>Example:</strong></p><p>The following command will import <span class="notranslate">Black List</span> and <span class="notranslate">White List</span> from the 3rd party IDS:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent import wblist
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><h2 id="infected-domains" tabindex="-1"><a class="header-anchor" href="#infected-domains" aria-hidden="true">#</a> Infected-domains</h2><p>Allows to retrieve infected domains list.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent infected-domains [--optional arguments]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><strong>Optional arguments:</strong></p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--limit</code></span></td><td>Limits the output with the specified number of domains.<br>Must be a number greater than zero. By default, equals 100.</td></tr><tr><td><span class="notranslate"><code>--offset</code></span></td><td>Offset for pagination. By default, equals 0.</td></tr></tbody></table><p><strong>Example:</strong></p><p>The following command displays the results of the <span class="notranslate"><code>check-domains</code></span> command. In case there are no infected domains located on the server, you will see no output. If there are any, you will get the following output:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent infected-domains
&#39;domain1.com&#39;
&#39;domain2.com&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="ip-list" tabindex="-1"><a class="header-anchor" href="#ip-list" aria-hidden="true">#</a> IP-List</h2><p>This CLI tool allows you to view or manage actual IPs within the local firewall lists.</p><p><strong>Usage:</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local [command] &lt;value&gt; [--option] 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>command</code> is a positional argument and can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>add</code></span></td><td>Add item(-s) from local ip-list</td></tr><tr><td><span class="notranslate"><code>delete</code></span></td><td>Remove item(-s) from local ip-list</td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>List item(-s) in local ip-list</td></tr></tbody></table><p><code>option</code>:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>-h</code>, <code>--help</code></span></td><td>Show this help message and exit</td></tr></tbody></table><p><code>value</code> is an item to manipulate with. It can be IP itself or a country code (find necessary country codes here in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#IPv4_CIDR_blocks" target="_blank" rel="noopener noreferrer">CIDR notation</a> in the column ISO ALPHA-2 CODE).</p><h3 id="list" tabindex="-1"><a class="header-anchor" href="#list" aria-hidden="true">#</a> List</h3><p><strong>Usage:</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local list [--options] &lt;value&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>options</code>:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--by-ip BY_IP</code></span></td><td>Filters output by abuser&#39;s IP or by subnet in CIDR notation.</td></tr><tr><td><span class="notranslate"><code>--purpose [PURPOSE ...]</code></span></td><td>IP List purpose can be:<br> <code>white</code> - do not block these IPs. <br><code>drop</code> - deny access on the network level (DROP packets via iptables, and respond with 403 on web ports even when the request comes through a proxy). <br> <code>captcha</code> - deny access on the network level for all non-web ports, show a Splash Screen challenge page on web ports. <br> <code>splashscreen</code> - check the visitor&#39;s browser before allowing access to websites.</td></tr><tr><td><span class="notranslate"><code>-by-country-code BY_COUNTRY_CODE</code></span></td><td>Filters output by country code. Requires valid country code as argument. Find valid country codes here <a href="https://www.nationsonline.org/oneworld/country_code_list.htm" target="_blank" rel="noopener noreferrer">www.nationsonline.org/oneworld/country_code_list.htm</a> in column ISO ALPHA-2 CODE.</td></tr><tr><td><span class="notranslate"><code>--by-comment BY_COMMENT</code></span></td><td>Filters output by comment</td></tr><tr><td><span class="notranslate"><code>--limit LIMIT</code></span></td><td>Limits the output with specified number of incidents</td></tr><tr><td><span class="notranslate"><code>--offset OFFSET</code></span></td><td>Offset for pagination</td></tr><tr><td><span class="notranslate"><code>--order-by [ORDER_BY ...]</code></span></td><td>List of fields to sort the results by</td></tr><tr><td><span class="notranslate"><code>--by-type {ip,country}</code></span></td><td>Filters output by item tipe [country</td></tr><tr><td><span class="notranslate"><code>--json</code></span></td><td>Returns data in JSON format</td></tr></tbody></table><div class="tip custom-block"><p class="custom-block-title"></p><p>Note that by default <code>list</code> command outputs only first 100 items in the list as if it was run as <code>imunify360-agent ip-list local list --limit 100</code>.</p></div><h3 id="blacklist" tabindex="-1"><a class="header-anchor" href="#blacklist" aria-hidden="true">#</a> Blacklist</h3><p>This command allows you to view or edit actual IPs in the Black List.</p><p><strong>Usage:</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local [command] --purpose drop &lt;value&gt; [--options]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>command</code> is a positional argument and can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>add</code></span></td><td>Add item(-s) from local ip-list</td></tr><tr><td><span class="notranslate"><code>delete</code></span></td><td>Remove item(-s) from local ip-list</td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>List item(-s) in local ip-list</td></tr></tbody></table><p><code>options</code> is a second positional argument and can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--purpose {white,drop,captcha}</code></span></td><td>IP List purpose can be <code>white</code> - do not block these IPs.<br><code>drop</code> - deny access on the network level (DROP packets via iptables, and respond with 403 on web ports even when the request comes through a proxy).<br><code>captcha</code> - deny access on the network level for all non-web ports, show a Splash Screen challenge page on web ports.<br> <code>splashscreen</code> - check the visitor&#39;s browser before allowing access to websites.</td></tr><tr><td><span class="notranslate"><code>--expiration EXPIRATION</code></span></td><td>Allows specifying expiration time for the listed IP (in seconds since epoch)</td></tr><tr><td><span class="notranslate"><code>-comment COMMENT</code></span></td><td>Allows to add comment to the item</td></tr><tr><td><span class="notranslate"><code>--scope {local,group}</code></span></td><td>Allows to set the scope to Global/Local. Accepts two values local (a default value, means &quot;add IP on this server only&quot;) and group (means &quot;add IP for the whole group in which this server is&quot;).</td></tr><tr><td><span class="notranslate"><code>--json</code></span></td><td>Returns data in JSON format</td></tr></tbody></table><p><strong>Examples:</strong></p><ul><li>The following command lists IP addresses added to the Black List:</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local list --purpose drop 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>The following command adds IP 1.2.3.4 to the Black List with a comment “one bad IP”:</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local add --purpose drop 1.2.3.4 --comment &quot;one bad IP&quot;
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>To check whether specific IP address is in the list, you can run the following command (where 12.34.56.78 is that specific IP address):</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local list --by-ip 12.34.56.78
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>The following command returns a list of IPs in the Black List which are from Bolivia (<a href="https://countrycode.org/" target="_blank" rel="noopener noreferrer">visit here</a> for other country codes):</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local list --by-country-code BO
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>The following command adds an IP 1.2.3.4 to the Black List and sets the scope to group:</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local add --purpose drop 1.2.3.4 --scope group
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>To blacklist multiple IP addresses, put them into a file and add to the black list as follows:</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cat list.txt | xargs -n 1 imunify360-agent ip-list local add --purpose drop
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The alternative would be using the <a href="/features/#external-black-whitelist-management" class="">external white/black list feature</a>.</p><ul><li>For the following example, the old blacklist command syntax is used. This command adds Bolivia to the Black List (available commands <code>blacklist country add</code>/<code>delete</code>/<code>edit</code>/<code>list</code>):</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent blacklist country add BO
OK 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>If an IP address has been added to the blacklist on a group of servers, it is enough to remove it from the blacklist on one of the servers, and it will be removed from the blacklist on all servers in the group.</p></div><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>For now, ipset supports only IPv6/64 networks. In most cases, it is enough to specify the mask <code>/64</code>. An example of a proper IPv6 address with the subnet mask: <code>2001:db8:abcd:0012::0/64</code>.</p></div><h3 id="graylist" tabindex="-1"><a class="header-anchor" href="#graylist" aria-hidden="true">#</a> Graylist</h3><p>This command allows to view or edit IP Gray List.</p><p><strong>Usage:</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local [command] --purpose captcha &lt;value&gt; [--options]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>command</code> is a positional argument and can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>delete</code></span></td><td>Remove item(-s) from local ip-list</td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>List item(-s) in local ip-list</td></tr></tbody></table><p><code>options</code> is a second positional argument and can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--purpose {white,drop,captcha}</code></span></td><td>IP List purpose can be <code>white</code> - do not block these IPs.<br><code>drop</code> - deny access on the network level (DROP packets via iptables, and respond with 403 on web ports even when the request comes through a proxy).<br><code>captcha</code> - deny access on the network level for all non-web ports, show a Splash Screen challenge page on web ports.<br> <code>splashscreen</code> - check the visitor&#39;s browser before allowing access to websites.</td></tr><tr><td><span class="notranslate"><code>--expiration EXPIRATION</code></span></td><td>Allows specifying expiration time for the listed IP (in seconds since epoch)</td></tr><tr><td><span class="notranslate"><code>-comment COMMENT</code></span></td><td>Allows to add comment to the item</td></tr><tr><td><span class="notranslate"><code>--scope {local,group}</code></span></td><td>Allows to set the scope to Global/Local. Accepts two values local (a default value, means &quot;add IP on this server only&quot;) and group (means &quot;add IP for the whole group in which this server is&quot;).</td></tr><tr><td><span class="notranslate"><code>--json</code></span></td><td>Returns data in JSON format</td></tr></tbody></table><p>Note that by default <code>list</code> command outputs only first 100 items in the list as if it was run as</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local list --purpose captcha --limit 100
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>or</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local list --purpose splashscreen –limit 100
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>Example</strong>:</p><ul><li>To check whether specific IP address is in the list, you can run the following command:</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local list --purpose captcha --by-ip 12.34.56.78
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>The following command will remove IP <code>1.2.3.4</code> from the Gray List:</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local delete --purpose captcha 12.34.56.78
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="whitelist" tabindex="-1"><a class="header-anchor" href="#whitelist" aria-hidden="true">#</a> Whitelist</h3><p>This command allows to view or edit actual IPs and domains in the White List.</p><p><strong>Usage:</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local [command] --purpose white &lt;value&gt; [--options]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>command</code> is a positional argument and can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>add</code></span></td><td>Add item(-s) from local ip-list</td></tr><tr><td><span class="notranslate"><code>delete</code></span></td><td>Remove item(-s) from local ip-list</td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>List item(-s) in local ip-list</td></tr></tbody></table><p><code>options</code> is a second positional argument and can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--purpose {white,drop,captcha}</code></span></td><td>IP List purpose can be <code>white</code> - do not block these IPs.<br><code>drop</code> - deny access on the network level (DROP packets via iptables, and respond with 403 on web ports even when the request comes through a proxy).<br><code>captcha</code> - deny access on the network level for all non-web ports, show a Splash Screen challenge page on web ports.<br> <code>splashscreen</code> - check the visitor&#39;s browser before allowing access to websites.</td></tr><tr><td><span class="notranslate"><code>--expiration EXPIRATION</code></span></td><td>Allows specifying expiration time for the listed IP (in seconds since epoch)</td></tr><tr><td><span class="notranslate"><code>-comment COMMENT</code></span></td><td>Allows to add comment to the item</td></tr><tr><td><span class="notranslate"><code>--scope {local,group}</code></span></td><td>Allows to set the scope to Global/Local. Accepts two values local (a default value, means &quot;add IP on this server only&quot;) and group (means &quot;add IP for the whole group in which this server is&quot;).</td></tr><tr><td><span class="notranslate"><code>--full-access</code></span></td><td>Only for the <code>add</code> command. Allows to grant full access to the IP or subnet ignoring the rules in Blocked ports.</td></tr><tr><td><span class="notranslate"><code>--no-full-access</code></span></td><td>Only for the <code>add</code> command. Allows to remove full access of the IP or subnet.</td></tr><tr><td><span class="notranslate"><code>--json</code></span></td><td>Returns data in JSON format</td></tr></tbody></table><p><strong>Examples:</strong></p><ul><li>The following commands adds IP 1.2.3.4 to the White List with a comment “one good ip”:</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local add --purpose white 11.22.33.44 --comment &quot;one good IP&quot;
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>To check whether specific IP address is in the list, you can run the following command (where 11.22.33.44 is that specific IP address):</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local list --purpose white --by-ip 11.22.33.44
AUTO_WHITELISTED  COMMENT       COUNTRY  CTIME       DEEP  EXPIRATION  FULL_ACCESS  IMPORTED_FROM  IP           MANUAL  NETMASK     NETWORK_ADDRESS  PURPOSE  SCOPE  VERSION
False             one good IP  US       1715940270  None  0           None         None           11.22.33.44  True    4294967295  185999660        white    local  4
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>The following command returns a list of IPs in the White List which are from United States:</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local list --by-country-code US
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>The following command adds an IP 1.2.3.4 to the White List and sets the scope to group:</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent ip-list local add --purpose white 1.2.3.4 --scope group
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>To whitelist multiple IP addresses, put them into a file and add to the white list as follows:</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cat list.txt | xargs -n 1 imunify360-agent ip-list local add --purpose white
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The alternative would be using the <a href="https://docs.imunify360.com/features/#external-black-whitelist-management" target="_blank" rel="noopener noreferrer">external white/black list feature</a>.</p><ul><li>For the following example, the old whitelist command syntax is used: <ul><li>The following command adds Bolivia to the White List (available commands <code>whitelist country add</code>/<code>delete</code>/<code>edit</code>/<code>list</code>):</li></ul></li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent whitelist country add BO
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>The following command adds domain with a name example.com to the White List (available commands: <code>add</code>/<code>delete</code>/<code>list</code>/<code>reset-to</code>):</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent whitelist domain add example.com
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="login" tabindex="-1"><a class="header-anchor" href="#login" aria-hidden="true">#</a> Login</h2><p>Allows to get a token which can be used for authentication in stand-alone Imunify UI.</p><p><strong>Usage</strong>:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent login [command] [--optional arguments]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>command</code></span> can be one of the following:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>get</code></span></td><td>returns a token for USERNAME (must be executed by root)</td></tr><tr><td><span class="notranslate"><code>pam</code></span></td><td>uses PAM to check the provided credential and returns a token for USERNAME if PASSWORD is correct</td></tr></tbody></table><p>Optional arguments for <span class="notranslate"><code>get</code></span>:</p><table><thead><tr><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--username USERNAME</code></span></td></tr></tbody></table><p>Optional arguments for <span class="notranslate"><code>pam</code></span>:</p><table><thead><tr><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--username USERNAME</code></span></td></tr><tr><td><span class="notranslate"><code>--password PASSWORD</code></span></td></tr></tbody></table><p><strong>Example</strong>:</p><ol><li>You can use the <span class="notranslate"><code>login get</code></span> command to implement your own authorization mechanism for stand-alone Imunify. For example, you can generate tokens for users which are already authorized in your system/panel, and redirect to stand-alone Imunify UI with <span class="notranslate"><code>https://example.com/#/login?token=&lt;TOKEN&gt;</code> or <code>https://example.com/#?token=&lt;TOKEN&gt;</code></span> in URL. (You can also set it in localStorage: <span class="notranslate"><code>localStorage.setItem(&#39;I360_AUTH_TOKEN&#39;, &#39;&lt;TOKEN&gt;&#39;);</code></span>). The output will display similar to the following:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent login get --username my-user1
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE2MDAyNDQwMTAuMDk5MzE5LCJ1c2VyX3R5cGUiOiJjbGllbnQiLCJ1c2VybmFtZSI6ImNsdGVzdCJ9.V_Q03hYw4dNLX5cewEb_h46hOw96KWBWP0E0ChbP3dA
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><ol start="2"><li>This command is used internally by stand-alone Imunify UI as the default authorization method.</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent login pam --username my-user1 --password ********
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><h2 id="malware" tabindex="-1"><a class="header-anchor" href="#malware" aria-hidden="true">#</a> Malware</h2><p>Allows to manage malware options.</p><p><strong>Usage</strong>:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent malware [command] [--optional arguments]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>Available commands:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>ignore</code></span></td><td>malware Ignore List operations</td></tr><tr><td><span class="notranslate"><code>malicious</code></span></td><td>malware Malicious List operations</td></tr><tr><td><span class="notranslate"><code>on-demand</code></span></td><td>on-demand Scanner operations</td></tr><tr><td><span class="notranslate"><code>suspicious</code></span></td><td>malware Suspicious List operations</td></tr><tr><td><span class="notranslate"><code>cleanup status</code></span></td><td>show the status of the cleanup process</td></tr><tr><td><span class="notranslate"><code>history list</code></span></td><td>lists the complete history of all malware-related incidents/actions (optional arguments available)</td></tr><tr><td><span class="notranslate"><code>rebuild patterns</code></span></td><td>allows to save changes after editing watched and excluded patterns for Malware Scanner. See details <a href="/faq_and_known_issues/#_21-how-to-edit-watched-and-excluded-patterns-for-malware-scanner" class="">here</a>.</td></tr><tr><td><span class="notranslate"><code>user</code></span></td><td>allows to perform Malware Scanner operations for a user</td></tr></tbody></table><p>Optional arguments:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--limit LIMIT</code></span></td><td>Limits the output with the specified number of domains.<br>Must be a number greater than zero. By default, equals 100.</td></tr><tr><td><span class="notranslate"><code>--offset OFFSET</code></span></td><td>Offset for pagination. By default, equals 0.</td></tr><tr><td><span class="notranslate"><code>--since SINCE</code></span></td><td>Start date.</td></tr><tr><td><span class="notranslate"><code>--to TO</code></span></td><td>End date.</td></tr><tr><td><span class="notranslate"><code>--user USER</code></span></td><td>Returns results for a chosen user.</td></tr><tr><td><span class="notranslate"><code>--order-by [ORDER_BY [ORDER_BY ...]]</code></span></td><td>Sorting order.</td></tr><tr><td><span class="notranslate"><code>--by-status [BY_STATUS [BY_STATUS ...]]</code></span></td><td>Return items with selected status.</td></tr><tr><td><span class="notranslate"><code>--by-scan-id BY_SCAN_ID</code></span></td><td>Return items with selected ID.</td></tr><tr><td><span class="notranslate"><code>--items ITEMS</code></span></td><td>Return selected items.</td></tr><tr><td><span class="notranslate"><code>--search SEARCH</code></span></td><td>Search query.</td></tr></tbody></table><p><span class="notranslate"><code>action</code></span> is the second positional argument for <span class="notranslate"><code>ignore</code></span> and can be one of the following:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>add</code></span></td><td>add file PATHS to the <span class="notranslate">Ignore List</span></td></tr><tr><td><span class="notranslate"><code>delete</code></span></td><td>delete file PATHS from the <span class="notranslate">Ignore List</span></td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>shows <span class="notranslate">Ignore List</span> entries (optional arguments apply)</td></tr></tbody></table><p>where PATHS are the absolute paths to files or folders divided by a whitespace.</p><p><span class="notranslate"><code>command2</code></span> is the second positional argument for the <span class="notranslate"><code>malicious</code></span> command and can be one of the following:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>cleanup</code></span></td><td>clean up infected ITEMS for a USER</td></tr><tr><td><span class="notranslate"><code>cleanup-all</code></span></td><td>clean up all files that have been detected as infected for all users</td></tr><tr><td><span class="notranslate"><code>restore-original</code></span></td><td>restore the original (malicious/infected) file to its original location</td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>list malicious/infected files</td></tr><tr><td><span class="notranslate"><code>move-to-ignore</code></span></td><td>move a <span class="notranslate">Malicious List</span> entry to the (malware) <span class="notranslate">Ignore List</span></td></tr><tr><td><span class="notranslate"><code>remove-from-list</code></span></td><td>remove malicious/infected files from the <span class="notranslate">Malicious List</span></td></tr><tr><td><span class="notranslate"><code>restore-from-backup</code></span></td><td>restore a clean version of infected file from backup</td></tr><tr><td><span class="notranslate"><code>restore-from-quarantine</code></span></td><td><b>deprecated in ver. 5.9.</b> Restore a quarantined file. The file will be automatically re-scanned</td></tr></tbody></table><p><span class="notranslate"><code>action</code></span> is the second positional argument for <span class="notranslate"><code>on-demand</code></span> and can be one of the following:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>list</code></span></td><td>list all on-demand scans performed</td></tr><tr><td><span class="notranslate"><code>start --path PATH</code></span></td><td>starts an on-demand scan for a specified PATH</td></tr><tr><td><span class="notranslate"><code>status</code></span></td><td>show the on-demand malware scanner status</td></tr><tr><td><span class="notranslate"><code>stop</code></span></td><td>stop on-demand malware scanner process</td></tr><tr><td><span class="notranslate"><code>queue put</code></span></td><td>put file PATHS to the queue for on-demand scan</td></tr><tr><td><span class="notranslate"><code>queue remove</code></span></td><td>remove scans from the queue for on-demand scan</td></tr></tbody></table><p>The optional arguments for <span class="notranslate"><code>on-demand start</code></span> and <span class="notranslate"><code>on-demand queue put</code></span> are:</p><table><thead><tr><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--ignore-mask IGNORE_MASK</code></span></td></tr><tr><td><span class="notranslate"><code>--follow-symlinks</code></span></td></tr><tr><td><span class="notranslate"><code>--no-follow-symlinks</code></span></td></tr><tr><td><span class="notranslate"><code>--file-mask FILE_MASK</code></span></td></tr><tr><td><span class="notranslate"><code>--intensity-cpu {1 to 7}</code></span> 1 means the lowest intensity, 7 means the highest intensity</td></tr><tr><td><span class="notranslate"><code>--intensity-io {1 to 7}</code></span> 1 means the lowest intensity, 7 means the highest intensity</td></tr></tbody></table><p><span class="notranslate"><code>action</code></span> is the second positional argument for <span class="notranslate"><code>suspicious</code></span> and can be one of:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>list</code></span></td><td>obtain the list of <span class="notranslate">Suspicious List</span> entries</td></tr><tr><td><span class="notranslate"><code>move-to-ignore</code></span></td><td>move a <span class="notranslate">Suspicious List</span> entry to the (malware) <span class="notranslate">Ignore List</span></td></tr></tbody></table><p><span class="notranslate"><code>action</code></span> is the second positional argument for <span class="notranslate"><code>user</code></span> and can be one of the following:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>cleanup USER</code></span></td><td>clean all infected files for a user</td></tr><tr><td><span class="notranslate"><code>restore-original USER</code></span></td><td>restore all original files for a user</td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>list all users and their current infection status</td></tr><tr><td><span class="notranslate"><code>scan</code></span></td><td>scan all users</td></tr></tbody></table><p><strong>Examples</strong></p><ol><li>The following command starts on-demand scanner for the path specified after the <span class="notranslate"><code>start</code></span> command:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent malware on-demand start --path /home/&lt;username&gt;/public_html/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol start="2"><li>The following command shows the example of the <span class="notranslate"><code>ignore-mask</code></span> usage when you have to scan all <code>d*</code> folders except for the <span class="notranslate"><code>dixon77w.com</code></span> and <span class="notranslate"><code>dunnrrr.com</code></span>:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent malware on-demand start --path=&#39;/var/www/vhosts/d*&#39; --ignore-mask=&#39;/var/www/vhosts/dixon77w.com/*,/var/www/vhosts/dunnrrr.com/*&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol start="3"><li>The following command adds on-demand scans for the selected path(s) to the scan queue</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent malware on-demand queue put &quot;/home/user1/some folder&quot; &quot;/home/user2&quot; --file-mask=&quot;*.php&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol start="4"><li>The following command removes the selected scans from the scan queue</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent malware on-demand list	# get scan_ids for the selected scans from the malicious list
imunify360-agent malware on-demand queue remove 84f043211dc045ae8e6d641f3b9fdb0a 8c4ee39d4d8f43e296e893940c8e791a
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><ol start="5"><li>The following command stops the on-demand Malware Scanner process</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent malware on-demand stop
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol start="6"><li>The following command stops the on-demand Malware Scanner process and clears the scan queue</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent malware on-demand stop --all
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol start="7"><li>The following command shows how to get an extended list of malicious files for a particular user. By default, a limit value equals to 50</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent malware malicious list --user cltest --limit 500
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>The list of the infected files found will be looking in the following way:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>
CLEANED_AT  CREATED     EXTRA_DATA  FILE  HASH  ID  MALICIOUS  SCAN_ID  SCAN_TYPE  SIZE  STATUS  TYPE  USERNAME
None        1599955297  {}          /home/cltest/public_html/test/TsMeJD.php        275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f  1627  True       1996cd86e6b14b12a1c165e79e3540d9  background  68    found   SMW-SA-05057-eicar.tst-4  cltest   
None        1599955297  {}          /home/cltest/public_html/test/TZlfnU.php        275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f  1628  True       1996cd86e6b14b12a1c165e79e3540d9  background  68    found   SMW-SA-05057-eicar.tst-4  cltest   
None        1599955297  {}          /home/cltest/public_html/test/Ke7V8n.php        275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f  1629  True       1996cd86e6b14b12a1c165e79e3540d9  background  68    found   SMW-SA-05057-eicar.tst-4  cltest   
None        1599955297  {}          /home/cltest/public_html/yoUq0L.php             275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f  1630  True       1996cd86e6b14b12a1c165e79e3540d9  background  68    found   SMW-SA-05057-eicar.tst-4  cltest   
None        1599955297  {}          /home/cltest/public_html/test/PKiuhY.php        275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f  1631  True       1996cd86e6b14b12a1c165e79e3540d9  background  68    found   SMW-SA-05057-eicar.tst-4  cltest   
None        1599955297  {}          /home/cltest/public_html/public_html/Zqrsvh.php  275a021bbfb6489e54d471899f7db9d1663fc695

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><ol start="8"><li>The following command adds the specified path to the Ignore List</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent malware ignore add /home/user1/public_html/ &quot;/home/some user/public_html/index.php&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol start="9"><li>The following command saves changes after editing watched and excluded patterns for Malware Scanner.</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent malware rebuild patterns
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol start="10"><li>The following command lists all users and their current infection status</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent malware user list
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>The successful initiation/stopping of a scanning process or adding of ignore directories/files should give you <code>OK</code> in the output.</p><h2 id="notifications-config" tabindex="-1"><a class="header-anchor" href="#notifications-config" aria-hidden="true">#</a> Notifications config</h2><p>Allows administrators to do the following:</p><ul><li>configure email addresses to submit reports on events execution</li><li>execute custom scripts on events execution</li></ul><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent notifications-config [command] [configuration options]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>command</code></span> can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>show</code></span></td><td>returns the full config as a JSON</td></tr><tr><td><span class="notranslate"><code>update</code></span></td><td>updates the config (partial update is supported) and returns the full updated config as a JSON</td></tr></tbody></table><p>We advise administrators to use the <span class="notranslate"><code>notifications-config show</code></span> to get the full config, pick what they want to edit, and feed it to the <span class="notranslate"><code>notifications-config update</code></span>.</p><p>The general structure of the <span class="notranslate"><code>imunify360-agent notifications-config show</code></span> command output:</p><div class="notranslate"><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>{
   &quot;rules&quot;: {
      &quot;SCRIPT_BLOCKED&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [], 
            &quot;period&quot;: 1,
            &quot;enabled&quot;: False
         }, 
         &quot;ADMIN&quot;: {
            &quot;period&quot;: 1,
            &quot;admin_emails&quot;: [],
            &quot;enabled&quot;: False
         }
      },
      &quot;USER_SCAN_FINISHED&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         }
      },
      &quot;USER_SCAN_MALWARE_FOUND&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         },
         &quot;ADMIN&quot;: {
         &quot;admin_emails&quot;: [],
         &quot;enabled&quot;: False
         }
      },
      &quot;USER_SCAN_STARTED&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         }
      },
      &quot;CUSTOM_SCAN_STARTED&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         }
      },
      &quot;REALTIME_MALWARE_FOUND&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [], 
            &quot;period&quot;: 1,
            &quot;enabled&quot;: False
         },
         &quot;ADMIN&quot;: {
            &quot;period&quot;: 1,
            &quot;admin_emails&quot;: [],
            &quot;enabled&quot;: False
         }
      },
      &quot;CUSTOM_SCAN_FINISHED&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         }
      },
      &quot;CUSTOM_SCAN_MALWARE_FOUND&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         },
         &quot;ADMIN&quot;: {
            &quot;admin_emails&quot;: [],
            &quot;enabled&quot;: False
         }
      }
   },
   &quot;admin&quot;: {
      &quot;notify_from_email&quot;: None,
      &quot;default_emails&quot;: []
   }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>Let&#39;s review all the options.</p><p>Rules:</p><ul><li><span class="notranslate">SCRIPT_BLOCKED</span> – occurs when the Proactive Defense has blocked malicious script.</li><li><span class="notranslate">USER_SCAN_FINISHED</span> – occurs immediately after the user scanning has finished, regardless the malware has found or not.</li><li><span class="notranslate">USER_SCAN_MALWARE_FOUND</span> – occurs when the malware scanning process of a user account has finished and malware found.</li><li><span class="notranslate">USER_SCAN_STARTED</span> – occurs immediately after the user scanning has started.</li><li><span class="notranslate">CUSTOM_SCAN_STARTED</span> – occurs immediately after on-demand (manual) scanning has started.</li><li><span class="notranslate">REALTIME_MALWARE_FOUND</span> – occurs when malware is detected during the real-time scanning.</li><li><span class="notranslate">CUSTOM_SCAN_FINISHED</span> – occurs immediately after on-demand (manual) scanning has finished, regardless the malware has found or not.</li><li><span class="notranslate">CUSTOM_SCAN_MALWARE_FOUND</span> – occurs when the on-demand scanning process has finished and malware found.</li></ul><p>Admin:</p><ul><li><span class="notranslate">default_emails</span> – specify the default list of emails used for all enabled admin email notifications.</li><li><span class="notranslate">notify_from_email</span> – specify a sender of all emails sent by the Hooks.</li></ul><p>Let&#39;s review all options for a specific event on the <span class="notranslate">REALTIME_MALWARE_FOUND</span> example:</p><div class="notranslate"><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>   &quot;REALTIME_MALWARE_FOUND&quot;: {
      &quot;SCRIPT&quot;: {
         &quot;scripts&quot;: [], 
         &quot;period&quot;: 1,
         &quot;enabled&quot;: False
      },
      &quot;ADMIN&quot;: {
         &quot;period&quot;: 1,
         &quot;admin_emails&quot;: [],
         &quot;enabled&quot;: False
      }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p><span class="notranslate"><strong>SCRIPT</strong></span></p><ul><li><span class="notranslate">scripts</span> – specify the full path to the script(s) or any other Linux executable to be launched on event occurrence. Make sure that the script has an executable bit (+x) on. A line-separated list of scripts is supported.</li><li><span class="notranslate">period</span> – set a notification interval in seconds. The data for all events that happened within the interval will be accumulated and sent altogether.</li><li><span class="notranslate">enabled</span> – run (<code>True</code>) a script (event handler) upon event occurrence.</li></ul><p><span class="notranslate"><strong>ADMIN</strong></span>:</p><ul><li><span class="notranslate">period</span> – set a notification interval in minutes. The data for all events that happened within the interval will be accumulated and sent altogether.</li><li><span class="notranslate">admin_emails</span> – set <code>default</code> to use the default administrator emails and/or specify your emails for notifications.</li><li><span class="notranslate">enabled</span> – notify (<code>True</code>) the administrator and a custom user list via email upon event occurrence.</li></ul><p><strong>Examples</strong>:</p><ol><li>Update admin default emails:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent notifications-config update &#39;{&quot;admin&quot;: {&quot;default_emails&quot;: [&quot;email1@email.com&quot;, &quot;email2@email.com&quot;]}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol start="2"><li>Enable and configure email notifications for <span class="notranslate">ADMIN</span> for the <span class="notranslate">REALTIME_MALWARE_FOUND</span> event:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent notifications-config update &#39;{&quot;rules&quot;: {&quot;REALTIME_MALWARE_FOUND&quot;: {&quot;ADMIN&quot;: {&quot;enabled&quot;: true, &quot;period&quot;: 3600, &quot;admin_emails&quot;: [&quot;email3@email.com&quot;, &quot;email4@email.com&quot;, &quot;default&quot;]}}}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>After the successful execution, the <span class="notranslate"><code>imunify360-agent notifications-config update</code></span> command returns the full config with changes.</p><p>The <span class="notranslate"><code>imunify360-agent notifications-config show</code></span> command output after applying the examples 1 and 2:</p><div class="notranslate"><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>{
   &quot;rules&quot;: {
      &quot;SCRIPT_BLOCKED&quot;: {
         &quot;ADMIN&quot;: {
            &quot;admin_emails&quot;: [],
            &quot;period&quot;: 1,
            &quot;enabled&quot;: False
         },
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;period&quot;: 1,
            &quot;enabled&quot;: False
         }
      },
      &quot;USER_SCAN_FINISHED&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         }
      }, 
      &quot;USER_SCAN_MALWARE_FOUND&quot;: {
         &quot;ADMIN&quot;: {
            &quot;admin_emails&quot;: [],
            &quot;enabled&quot;: False
         },
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         }
      },
      &quot;CUSTOM_SCAN_STARTED&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         }
      },
      &quot;REALTIME_MALWARE_FOUND&quot;: {
         &quot;ADMIN&quot;: {
            &quot;admin_emails&quot;: [&#39;email3@email.com&#39;, &#39;email4@email.com&#39;, &#39;default&#39;],
            &quot;period&quot;: 3600,
            &quot;enabled&quot;: True
         },
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;period&quot;: 1,
            &quot;enabled&quot;: False
         }
      },
      &quot;USER_SCAN_STARTED&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         }
      },
      &quot;CUSTOM_SCAN_FINISHED&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         }
      },
      &quot;CUSTOM_SCAN_MALWARE_FOUND&quot;: {
         &quot;ADMIN&quot;: {
            &quot;admin_emails&quot;: [],
            &quot;enabled&quot;: False
         },
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         }
      }
   },
   &quot;admin&quot;: {
      &quot;notify_from_email&quot;: None,
      &quot;default_emails&quot;: [&quot;email1@email.com&quot;, &quot;email2@email.com&quot;]
   }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p><strong>More examples</strong>:</p><ol start="3"><li>Run the custom script on the <span class="notranslate">USER_SCAN_FINISHED</span> event occurrence:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent notifications-config update &#39;{&quot;rules&quot;: {&quot;USER_SCAN_FINISHED&quot;: {&quot;SCRIPT&quot;: {&quot;scripts&quot;: [&quot;/script/my-handler.py&quot;], &quot;enabled&quot;: true}}}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol start="4"><li>Change the period for the <span class="notranslate">SCRIPT</span> hook for the <span class="notranslate">REALTIME_MALWARE_FOUND</span> event to 1 minute:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent notifications-config update &#39;{&quot;rules&quot;: {&quot;REALTIME_MALWARE_FOUND&quot;: {&quot;SCRIPT&quot;: {&quot;period&quot;: 60}}}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>After the successful execution, the <span class="notranslate"><code>imunify360-agent notifications-config update</code></span> command returns the full config with changes.</p><p>The <span class="notranslate"><code>imunify360-agent notifications-config show</code></span> command output after applying the examples 3 and 4:</p><div class="notranslate"><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>{
   &quot;rules&quot;: {
      &quot;CUSTOM_SCAN_MALWARE_FOUND&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         },
         &quot;ADMIN&quot;: {
            &quot;enabled&quot;: False,
            &quot;admin_emails&quot;: []
         }
      },
      &quot;USER_SCAN_STARTED&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         }
      },
      &quot;CUSTOM_SCAN_FINISHED&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         }
      },
      &quot;SCRIPT_BLOCKED&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;period&quot;: 1,
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         },
         &quot;ADMIN&quot;: {
            &quot;period&quot;: 1,
            &quot;enabled&quot;: False,
            &quot;admin_emails&quot;: []
         }
      },
      &quot;CUSTOM_SCAN_STARTED&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         }
      },
      &quot;USER_SCAN_MALWARE_FOUND&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         },
         &quot;ADMIN&quot;: {
            &quot;enabled&quot;: False,
            &quot;admin_emails&quot;: []
         }
      },
      &quot;REALTIME_MALWARE_FOUND&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;period&quot;: 60,
            &quot;scripts&quot;: [],
            &quot;enabled&quot;: False
         },
         &quot;ADMIN&quot;: {
            &quot;period&quot;: 3600,
            &quot;enabled&quot;: True,
            &quot;admin_emails&quot;: [&#39;email3@email.com&#39;, &#39;email4@email.com&#39;, &#39;default&#39;]
         }
      },
      &quot;USER_SCAN_FINISHED&quot;: {
         &quot;SCRIPT&quot;: {
            &quot;scripts&quot;: [&#39;/script/my-handler.py&#39;],
            &quot;enabled&quot;: True
         }
      }
   },
   &quot;admin&quot;: {
      &quot;notify_from_email&quot;: None,
      &quot;default_emails&quot;: [&quot;email1@email.com&quot;, &quot;email2@email.com&quot;]
   }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h4 id="example-of-scripts-to-create-custom-notifications" tabindex="-1"><a class="header-anchor" href="#example-of-scripts-to-create-custom-notifications" aria-hidden="true">#</a> Example of scripts to create custom notifications</h4><p>Simple and generic scripts aiming to be a reference/template to create custom scripts to use with imunify-notifier.</p><p><strong>For notifications subsystem:</strong></p><ul><li><a href="/notification_script.sh">Shell script</a></li></ul><p><strong>For hooks subsystem:</strong></p><ul><li><a href="/hook_script.sh">Shell script</a></li><li><a href="/hook_script.py">Python script</a></li></ul><p>You can use these scripts as a reference and customize them.</p><div class="warning custom-block"><p class="custom-block-title">Note</p><p>Set the <code>+x</code> bits to your script file to make it executable. Your script also has to be readable by the special <span class="notranslate"><code>_imunify</code></span> user, so make sure of setting group&#39;s permission accordingly:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>chown root:_imunify hook_script.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div></div><h4 id="python-script-description" tabindex="-1"><a class="header-anchor" href="#python-script-description" aria-hidden="true">#</a> Python script description</h4><p>The agent generates messages of different types on hook events. The ‘if chain’ in the script calls the particular method corresponding to type of the event that came from the agent.</p><p>For example, if you&#39;d like to block sites for all users, that were detected as infected by realtime scan you can use the <code>handle_realtime_malware_found</code> method.</p><p>To unblock user sites which were scanned as clean, you can use the <code>handle_user_scan_finished</code> method.</p><p>Add your path to the related hook (or multiple hooks) and implement the custom logic of blocking and unblocking sites.</p><p>Also in this script you could find the way to parse JSON that come from Imunify360 and description of this JSON schema in every possible case. Such descriptions are provided by docstring of the <span class="notranslate"><code>handle</code></span> methods.</p><h4 id="adding-custom-email-template" tabindex="-1"><a class="header-anchor" href="#adding-custom-email-template" aria-hidden="true">#</a> Adding custom email template</h4><p>Imunify Notifications Engine supports adding custom email messages either the header or body. It may be useful for adding warnings or any message.</p><p>To add a custom email template, follow these steps:</p><ol><li>Enable notification for the <span class="notranslate"><code>CUSTOM_SCAN_MALWARE_FOUND</code></span> event. It is triggered by a malware caught by on-demand scan:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent notifications-config update &#39;{&quot;rules&quot;: {&quot;CUSTOM_SCAN_MALWARE_FOUND&quot;: {&quot;ADMIN&quot;: {&quot;enabled&quot;: true, &quot;admin_emails&quot;: [&quot;your-email@example.domain&quot;]}}}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol start="2"><li>Create template directory:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>mkdir -p /etc/imunify360/emails/custom_scan_malware_found
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol start="3"><li>Add a &quot;Hello World&quot; template:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cat &lt;&lt;EOF &gt; /etc/imunify360/emails/custom_scan_malware_found/en.json
[
    {
        &quot;id&quot;: &quot;subject&quot;,
        &quot;other&quot;: &quot;TESTING templates on {{serverName}}&quot;
    },
    {
        &quot;id&quot;: &quot;scan_description_section&quot;,
        &quot;other&quot;: &quot;Hello World, from custom template test&quot;
    }
]
EOF

cat &lt;&lt;EOF &gt; /etc/imunify360/emails/custom_scan_malware_found/t.tmpl
From: {{.mail_from}}
To: {{.mail_to}}
Subject: {{.messages.subject}}

{{.messages.scan_description_section}}
EOF
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>More examples are available at: <strong>/usr/share/imunify-notifier/templates/</strong></p><h2 id="proactive" tabindex="-1"><a class="header-anchor" href="#proactive" aria-hidden="true">#</a> Proactive</h2><p>These commands allow to manage <span class="notranslate">Proactive Defense</span> feature.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent proactive [command] [--option] &lt;value&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>Available commands:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>ignore delete path</code></span></td><td>allows to remove a file from <span class="notranslate">Proactive Defense Ignore List</span>.</td></tr><tr><td><span class="notranslate"><code>ignore delete rule</code></span></td><td>allows to remove a rule for a file from <span class="notranslate">Proactive Defense Ignore List</span>.</td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>allows to list <span class="notranslate">Proactive Defense</span> events.</td></tr><tr><td><span class="notranslate"><code>details</code></span></td><td>allows to show details for the event.</td></tr><tr><td><span class="notranslate"><code>ignore list</code></span></td><td>allows to list files included to <span class="notranslate">Proactive Defense Ignore List</span>.</td></tr><tr><td><span class="notranslate"><code>ignore add</code></span></td><td>allows to add a file to <span class="notranslate">Proactive Defense Ignore List</span>.</td></tr></tbody></table><p><span class="notranslate"><code>option</code></span> can be one or few of the optional arguments listed above and one more.</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--path</code></span></td><td>for <span class="notranslate"><code>ignore add</code></span>, <span class="notranslate"><code>ignore delete path</code></span>, <span class="notranslate"><code>ignore delete rule</code></span> commands.<br>Allows to specify a path to the file.</td></tr><tr><td><span class="notranslate"><code>--id</code></span></td><td>for <span class="notranslate"><code>details</code></span>, <span class="notranslate"><code>ignore delete rule</code></span> commands.<br>Allows to specify rule id.</td></tr><tr><td><span class="notranslate"><code>--rule-id</code></span></td><td>only for <span class="notranslate"><code>ignore add</code></span> command.<br>Allows to specify rule id.</td></tr><tr><td><span class="notranslate"><code>--rule-name</code></span></td><td>only for <span class="notranslate"><code>ignore add</code></span> command.<br>Allows to specify rule name.</td></tr><tr><td><span class="notranslate"><code>--since [timestamp]</code></span></td><td>allows to set start time to filter the list of incidents by period.</td></tr><tr><td><span class="notranslate"><code>--to [timestamp]</code></span></td><td>allows to set finish time to filter the list of incidents by period.</td></tr><tr><td><span class="notranslate"><code>--user</code></span></td><td>show events for a specific user.</td></tr><tr><td><span class="notranslate"><code>--search</code></span></td><td>string to search Proactive events by.</td></tr></tbody></table><p><strong>Examples:</strong></p><ol><li>This command adds a file located at <span class="notranslate"><code>/home/user/index.php</code></span> to <span class="notranslate">Proactive Defense Ignore List</span> for the rule id 12 and name <span class="notranslate"><code>Suspicious detection rule</code></span>. It means that <span class="notranslate">Proactive Defense</span> will not analyze this file according to this rule:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent proactive ignore add --path /home/user/index.php --rule-id 12 --rule-name &#39;Suspicious detection rule&#39;
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><ol start="2"><li>This command removes files located at <span class="notranslate"><code>&lt;path to file 1&gt;</code></span> and <span class="notranslate"><code>&lt;path to file 2&gt;</code></span> from <span class="notranslate">Proactive Defense Ignore List</span>:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent proactive ignore delete path &lt;path to file 1&gt; &lt;path to file 2&gt;
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="register" tabindex="-1"><a class="header-anchor" href="#register" aria-hidden="true">#</a> Register</h2><p>Allows to register and activate Imunify360. You can use it in case if Imunify360 was not activated during installation process or in case if activation key of the Imunify360 was changed for any reason. If you do not know what is an activation key or have any problem with it then, please, read <a href="/installation/" class="">Installation guide</a> or contact our <a href="https://cloudlinux.zendesk.com/hc/requests/new" target="_blank" rel="noopener noreferrer">support team</a>.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent register [--optional arguments] [KEY]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>KEY</code></span> is a positional argument:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>KEY</code></span></td><td>Register with activation key (use <span class="notranslate"><code>IPL</code></span> to register by IP).</td></tr></tbody></table><p>If you will use this command without the <span class="notranslate"><code>KEY</code></span> argument, then it will try to register and activate current activation key.</p><p>In case when the number of users on the server changes and one license is replaced by another, it is necessary to run the following command to update the license:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent update-license
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><p><strong>Example 1:</strong></p><p>The following command will register and activate Imunify360 with the provided activation key:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent register IM250sdfkKK245kJHIL
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><p><strong>Example 2:</strong></p><p>If you have an IP-based license, you can use <span class="notranslate"><code>IPL</code></span> argument to register and activate Imunify360:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent register IPL
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="reload-lists" tabindex="-1"><a class="header-anchor" href="#reload-lists" aria-hidden="true">#</a> Reload lists</h2><p>Allows to use external files with the list of Black/White-listed IPs.</p><p><strong>Usage</strong>:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent reload-lists
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><strong>Example</strong>:</p><p>To use external files with the list of Black/White-listed IPs, you should place this list into one of the following directories: <span class="notranslate"><code>/etc/imunify360/whitelist/*.txt</code></span> for the White list and <span class="notranslate"><code>/etc/imunify360/blacklist/*.txt</code></span> for the Black list. Then in order to apply the IP lists, you should run the following command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent reload-lists
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="remote-proxy" tabindex="-1"><a class="header-anchor" href="#remote-proxy" aria-hidden="true">#</a> Remote-proxy</h2><p>Allows to add an additional proxy subnet.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent remote-proxy [commands] [--optional arguments]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>Positional arguments:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>add</code></span></td><td>Add proxy subnet in CIDR notation</td></tr><tr><td><span class="notranslate"><code>delete</code></span></td><td>Delete proxy subnet in CIDR notation</td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>List of manually added proxies</td></tr><tr><td><span class="notranslate"><code>group</code></span></td><td>Manage proxies by name</td></tr></tbody></table><p>Positional arguments for <span class="notranslate"><code>add</code></span>:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>NETWORKS</code></span></td><td>Subnet in CIDR notation</td></tr></tbody></table><p>Optional arguments for <span class="notranslate"><code>add</code></span>:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--name NAME</code></span></td><td>Name of an added proxy</td></tr></tbody></table><p>Positional arguments for <span class="notranslate"><code>delete</code></span>:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>NETWORKS</code></span></td><td>Subnet in CIDR notation</td></tr></tbody></table><p>Optional arguments for <span class="notranslate"><code>list</code></span>:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--by-group BY_GROUP</code></span></td><td>Sort by <span class="notranslate"><code>GROUP</code></span></td></tr><tr><td><span class="notranslate"><code>--by-source BY_SOURCE</code></span></td><td>Sort by <span class="notranslate"><code>SOURCE</code></span></td></tr></tbody></table><p>Positional arguments for <span class="notranslate"><code>group</code></span>:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>enable</code></span></td><td>Enable group</td></tr><tr><td><span class="notranslate"><code>disable</code></span></td><td>Disable group</td></tr></tbody></table><p>Positional arguments for <span class="notranslate"><code>enable</code>/<code>disable</code></span>:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>name</code></span></td><td>Name of your proxy subnet</td></tr></tbody></table><p>Optional arguments for <span class="notranslate"><code>enable</code>/<code>disable</code></span>:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--source SOURCE</code></span></td><td>Enable/disable a group by <span class="notranslate"><code>SOURCE</code></span></td></tr></tbody></table><p><strong>Examples</strong></p><p>The following command adds proxy subnet 1.1.2.0/24 with name <span class="notranslate"><code>my_own_proxy</code></span></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent remote-proxy add 1.1.2.0/24 --name &quot;my_own_proxy&quot;
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="rstatus" tabindex="-1"><a class="header-anchor" href="#rstatus" aria-hidden="true">#</a> Rstatus</h2><p>Allows to check if Imunify360 server license is valid.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent rstatus [--optional arguments]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>An extended variation (otherwise, you receive <code>OK</code> if everything is fine with the license registered):</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent rstatus --json -v

{
  &quot;expiration&quot;: null,
  &quot;id&quot;: &quot;SSXX11xXXXxxxxXX&quot;,
  &quot;license&quot;: {
    &quot;expiration&quot;: null,
    &quot;id&quot;: &quot;SSXX11xXXXxxxxXX&quot;,
    &quot;license_type&quot;: &quot;imunify360&quot;,
    &quot;message&quot;: &quot;&quot;,
    &quot;redirect_url&quot;: &quot; &quot;,
    &quot;status&quot;: true,
    &quot;user_count&quot;: 100,
    &quot;user_limit&quot;: 2147483647
  },
  &quot;license_type&quot;: &quot;imunify360&quot;,
  &quot;message&quot;: &quot;&quot;,
  &quot;redirect_url&quot;: &quot; &quot;,
  &quot;status&quot;: true,
  &quot;strategy&quot;: &quot;PRIMARY_IDS&quot;,
  &quot;user_count&quot;: 100,
  &quot;user_limit&quot;: 2147483647,
  &quot;version&quot;: &quot;5.1.2-1&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="rules" tabindex="-1"><a class="header-anchor" href="#rules" aria-hidden="true">#</a> Rules</h2><p>This command allows user to manage rules disabled for firewall plugins Imunify360 uses.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent rules [command] [--option] &lt;value&gt; [--option] &lt;value&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>command</code></span> is a positional argument and can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>disable</code></span></td><td>add a new rule to the disabled rules list</td></tr><tr><td><span class="notranslate"><code>enable</code></span></td><td>remove a rule from the disabled rules list</td></tr><tr><td><span class="notranslate"><code>list-disabled</code></span></td><td>display the list of the disabled rules</td></tr><tr><td><span class="notranslate"><code>update-app-specific-rules</code></span></td><td>allows to update WAF ruleset configurator immediately (generally, executed by cron)</td></tr></tbody></table><p>Option can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--id</code></span></td><td>ID number of the rule provided by the firewall plugin.</td></tr><tr><td><span class="notranslate"><code>--plugin</code></span></td><td>Firewall plugin name. Can be one of the following:<ul><li><span class="notranslate"><code>modsec</code></span> for ModSecurity</li><li><span class="notranslate"><code>ossec</code></span> for OSSEC</li><li><span class="notranslate"><code>lfd</code></span> Login Failure Daemon (can be used in CSF integration mode)</li></ul></td></tr><tr><td><span class="notranslate"><code>--name</code></span></td><td>Name of the added rule or details of the rule from <span class="notranslate">ModSecurity</span> or OSSEC.</td></tr><tr><td><span class="notranslate"><code>--domains</code></span></td><td>List of domains to disable a rule for. Can only be used with <code>modsec</code> type.</td></tr></tbody></table><p><strong>Examples</strong></p><ol><li>The following command adds a rule with id 42 and name <span class="notranslate">‘Rule name’</span> for the <span class="notranslate">ModSecurity</span> rules to the disabled rules list:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent rules disable --id 42 --plugin modsec --name &#39;Rule name&#39;
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><ol start="2"><li>The following command removes a rule with id 42 for the ModSecurity rules from the disabled rules list:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent rules enable --id 42 --plugin modsec
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><ol start="3"><li>The following command displays the list of disabled rules:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent rules list-disabled
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>The list is displayed as follows:</p><div class="notranslate"><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>{&#39;plugin&#39;: &#39;modsec&#39;, &#39;id&#39;: &#39;214920&#39;, &#39;domains&#39;: [&#39;captchatest.com&#39;], &#39;name&#39;: &#39;Imported from config&#39;}

{&#39;plugin&#39;: &#39;modsec&#39;, &#39;id&#39;: &#39;42&#39;, &#39;domains&#39;: None, &#39;name&#39;: &#39;Rule name&#39;}

{&#39;plugin&#39;: &#39;ossec&#39;, &#39;id&#39;: &#39;1003&#39;, &#39;domains&#39;: None, &#39;name&#39;: &#39;Imported from config&#39;}

{&#39;plugin&#39;: &#39;ossec&#39;, &#39;id&#39;: &#39;2502&#39;, &#39;domains&#39;: None, &#39;name&#39;: &#39;User missed the password more than one time&#39;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>Where</p><ul><li><span class="notranslate">plugin</span> — is a firewall plugin name (modsec for <span class="notranslate">ModSecurity</span> and ossec for OSSEC)</li><li>id — is id number of the rule provided by the firewall plugin</li><li><span class="notranslate">domains</span> — the list of the domains for which the rule is disabled (None means all domains)*</li><li><span class="notranslate">name</span> — rule description or details of the rule from ModSecurity or OSSEC</li></ul><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Domains are specified only for <span class="notranslate">ModSecurity</span> rules. For OSSEC rules it is always applies to all domains.</p></div><p>4. The following command updates the WAF ruleset configurator immediately:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent rules update-app-specific-rules
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="submit-false-positive-false-negative" tabindex="-1"><a class="header-anchor" href="#submit-false-positive-false-negative" aria-hidden="true">#</a> Submit false-positive/false-negative</h2><p>To submit file as false positive (if Imunify360 considers file as a malicious but it actually isn&#39;t) you can use the following command. Make sure to specify the file name. Relative paths are also supported as well as full paths.</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent submit false-positive --reason &lt;reason&gt; &lt;file&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p><span class="notranslate"><code>--scanner</code></span> argument is deprecated and will be ignored, because there is only one vendor now: <span class="notranslate"><code>ai-bolit</code></span></p></div><p>To submit file as false negative (if Imunify360 considers file as a non-malicious but it actually does) you can use the following command (please make sure to specify the file name along with full path):</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent submit false-negative &lt;file&gt;
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><p>Optional arguments:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>--to</code></span></td><td>Email to send.</td></tr><tr><td><span class="notranslate"><code>--sender</code></span></td><td>User email.</td></tr></tbody></table><h3 id="false-positive-false-negative-file-submission-tool" tabindex="-1"><a class="header-anchor" href="#false-positive-false-negative-file-submission-tool" aria-hidden="true">#</a> False-positive/False-negative File Submission Tool</h3><p>This section describes how to use Imunify false positive/false negative submission tool. This tool allows you to submit files for analysis, review the list of your submissions, and monitor their statuses</p><h4 id="preparation" tabindex="-1"><a class="header-anchor" href="#preparation" aria-hidden="true">#</a> Preparation</h4><p>The configuration phase consists of two steps:</p><ol><li><strong>Get an API token</strong>. For the first run, a new API key should be created. Navigate to cm.imunify.com/#/tokens. Use Imunify/CLN account credentials to log in. Get a new key by clicking on the button &quot;Create API key&quot;</li></ol><img src="/images/create-api-key-button.png" width="200"><p>The API key can be used as many times as needed across all servers for the individual Imunify customer.</p><ol start="2"><li><strong>Get the script and set permissions</strong>. Run the script shown below. Please note that the script has to be executed with root privileges since it requires access to Imunify license file.</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># curl -o fpfn-submission.sh https://files.imunify360.com/static/cm/fpfn-submission.sh 
# chmod 700 fpfn-submission.sh 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="requirements" tabindex="-1"><a class="header-anchor" href="#requirements" aria-hidden="true">#</a> Requirements</h4><p>For this process to work properly you need the following prerequisites:</p><ul><li><strong>JSON Processor</strong>. Jq is required to run the tool. If it is not installed please run the script below.</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># yum install jq -y 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><strong>Imunify360 v6.7.3+</strong> is required. Follow the <a href="https://blog.imunify360.com/release-notes-imunify360-v.6.8-beta" target="_blank" rel="noopener noreferrer">update instructions</a> if the version you use is the earlier one.</li><li><strong>Submission script</strong>. The submission tool that can be downloaded from <a href="https://files.imunify360.com/static/cm/fpfn-submission.sh" target="_blank" rel="noopener noreferrer">https://files.imunify360.com/static/cm/fpfn-submission.sh</a>.</li></ul><h4 id="usage-1" tabindex="-1"><a class="header-anchor" href="#usage-1" aria-hidden="true">#</a> Usage</h4><p>We designed the submission script to accept arguments through the use of the environment variables. Here is the output of the <code>--help</code> page.</p><img src="/images/submission-tool-help.png" width="600"><h4 id="file-submission" tabindex="-1"><a class="header-anchor" href="#file-submission" aria-hidden="true">#</a> File submission</h4><p>The following code snippets can be used to submit the false_negative file for analysis:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># FILE_PATH=./eicar.suspicious REASON=false_negative NOTE=&#39;support ticket 400&#39; API_TOKEN=&lt;YOUR_API_KEY&gt; ./fpfn submission.sh -p
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The response is made to be transparent. The <code>_id</code> field represents a unique submission ID.</p><img src="/images/file-submission-output.png" width="600"><h4 id="fetching-results" tabindex="-1"><a class="header-anchor" href="#fetching-results" aria-hidden="true">#</a> Fetching results</h4><p>The results of submission processing can be viewed in 1-3 business days using a set of various filters (see <code>--help</code>). The following code uses NOTE to fetch results:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># NOTE=&quot;400&quot; API_TOKEN=&lt;YOUR_API_KEY&gt; ./fpfn-submission.sh -g 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Here is the response:</p><img src="/images/fetching-results-submission-tool.png" width="600"><p>The response contains the section <code>verdicts</code> that describes the processing results. For recent verdicts, it may contain a signature base build id, e.g.</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>   { 
      &quot;date&quot;: &quot;2022-11-11 20:14:40&quot;, 
      &quot;verdict&quot;: &quot;malicious&quot;, 
      &quot;comment&quot;: &quot;Added after scan with build 9231&quot; 
   }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If the verdicts section is empty, it means that the file is in process.</p><h4 id="feedback" tabindex="-1"><a class="header-anchor" href="#feedback" aria-hidden="true">#</a> Feedback</h4><p>Please reach out to us should you have any concerns, questions, and/or feedback. We appreciate all the communication from you.</p><h2 id="unregister" tabindex="-1"><a class="header-anchor" href="#unregister" aria-hidden="true">#</a> Unregister</h2><p>Allows to unregister and disable Imunify360 on the server.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>To remove Imunify360 from the server it needs to be <a href="/uninstall/" class="">uninstalled</a>.</p></div><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent unregister [--optional arguments]
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="vendors" tabindex="-1"><a class="header-anchor" href="#vendors" aria-hidden="true">#</a> Vendors</h2><p>Command for manipulating Imunify360 vendors.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent [command]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>command</code></span> is a positional argument and can be:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>install-vendors</code></span></td><td>Install ModSecurity vendors.<br>This command will install the Imunify360 vendor<br>if there are no conflicts with other installed vendors.</td></tr><tr><td><span class="notranslate"><code>uninstall-vendors</code></span></td><td>uninstall <span class="notranslate">ModSecurity</span> vendors.</td></tr></tbody></table><p><strong>Example:</strong></p><p>The following command uninstalls the <span class="notranslate">ModSecurity</span> vendors:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent uninstall-vendors
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="version" tabindex="-1"><a class="header-anchor" href="#version" aria-hidden="true">#</a> Version</h2><p>Allows to view the actual Imunify360 version installed on the server.</p><p><strong>Usage:</strong></p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent version [--json]
4.9.5-3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="whitelisted-crawlers" tabindex="-1"><a class="header-anchor" href="#whitelisted-crawlers" aria-hidden="true">#</a> Whitelisted crawlers</h2><p>Allows do operate with search engine domains.</p><p><strong>Usage</strong>:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent whitelisted-crawlers [command] 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p><span class="notranslate"><code>command</code></span> can be one of the following:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><span class="notranslate"><code>add NAME</code></span></td><td>add a search engine to the list of whitelisted crawlers</td></tr><tr><td><span class="notranslate"><code>delete NAME</code></span></td><td>delete a search engine to the list of whitelisted crawlers</td></tr><tr><td><span class="notranslate"><code>list</code></span></td><td>list all added whitelisted crawlers</td></tr></tbody></table><p><strong>Examples</strong>:</p><ol><li><p>This command adds two search engines to the list of whitelisted crawlers:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent whitelisted-crawlers add yandex.com google.com
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div></li><li><p>This command deletes a search engine to the list of whitelisted crawlers</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent whitelisted-crawlers delete yandex.com
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div></li><li><p>This command lists all added whitelisted crawlers</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent whitelisted-crawlers list
DESCRIPTION  DOMAINS                                       ID
Google       [&#39;.google.com&#39;, &#39;.googlebot.com&#39;]             1 
Yandex       [&#39;.yandex.ru&#39;, &#39;.yandex.com&#39;, &#39;.yandex.net&#39;]  2 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></li></ol></div><div class="page-edit"><div class="edit-link"><img src="/global/pen.svg" alt="icon pen"><a href="https://github.com/cloudlinux/imunify360-documentation/tree/master/docs/command_line_interface/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a></div></div><div class="back-to-top" data-v-1eb13e00><a class="nav-arrow top back-to-top__link" data-v-1eb13e00><span class="back-to-top__link-span" data-v-1eb13e00>Scroll up</span></a></div><!--[--><!--]--></div><!----><div class="footer footer-default-layout" data-v-f2902e71><div class="footer__img" data-v-f2902e71><a href="https://cloudlinux.com" data-v-f2902e71><img src="/global/we-are-cloudlinux.svg" data-v-f2902e71></a></div><div class="footer-company-title" data-v-f2902e71>2024. CloudLinux Inc </div><div class="social" data-v-f2902e71><div class="social_links" data-v-f2902e71><!--[--><a href="https://cloudlinux.zendesk.com/hc/en-us/categories/360002375980-Imunify-Security-Products" target="_blank" data-v-f2902e71>Knowledge Base</a><a href="https://forum.cloudlinux.com/forum/imunify360" target="_blank" data-v-f2902e71>Forum</a><a href="https://blog.imunify360.com/" target="_blank" data-v-f2902e71>Blog</a><a href="https://www.cloudlinux.com/privacy-policy" target="_blank" data-v-f2902e71>Privacy Policy</a><!--]--></div><span class="footer-social-text" data-v-f2902e71>Stay in touch</span><div class="social-icons-wrapper" data-v-f2902e71><!--[--><a class="social-icons-link" href="https://www.facebook.com/imunify360/" target="_blank" data-v-f2902e71><img class="social-icons-link-img" src="/footer-social/fb.png" alt="footer logo" data-v-f2902e71></a><a class="social-icons-link" href="https://twitter.com/imunify360/" target="_blank" data-v-f2902e71><img class="social-icons-link-img" src="/footer-social/tw.png" alt="footer logo" data-v-f2902e71></a><a class="social-icons-link" href="https://linkedin.com/company/imunify360" target="_blank" data-v-f2902e71><img class="social-icons-link-img" src="/footer-social/in.png" alt="footer logo" data-v-f2902e71></a><a class="social-icons-link" href="https://www.youtube.com/channel/UCcW6dDJjcy41c7Hl_5LdLZQ" target="_blank" data-v-f2902e71><img class="social-icons-link-img" src="/footer-social/ytube.png" alt="footer logo" data-v-f2902e71></a><!--]--></div></div></div></div><!----><!--]--></div>
    <script type="module" src="/assets/app-ab3f7917.js" defer></script>
  </body>
</html>
