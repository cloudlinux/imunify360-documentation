import{_ as t,n as s,p as o,a2 as n,q as e,J as l}from"./framework-8c389947.js";const r={};function i(u,a){return s(),o("div",null,a[0]||(a[0]=[n('<h1 id="config-file-description" tabindex="-1"><a class="header-anchor" href="#config-file-description" aria-hidden="true">#</a> Config File Description</h1><p>Imunify360 config file is available on the following location after installation:</p><p><span class="notranslate"><em>/etc/sysconfig/imunify360/imunify360.config</em></span></p><p>In the config file it is possible to set up Imunify360 configuration. The following options are available:</p><div class="tip custom-block"><p class="custom-block-title"></p><p>Note that if YAML is used, it accepts any format: <code>True</code>/<code>true</code>/<code>yes</code>/<code>y</code>, etc. However, the CLI uses JSON which is strict – only lowercase <code>true</code>/<code>false</code>. Thus, if you are using the <code>imunify360-agent</code> CLI tool to make changes to the configuration, make sure you are using the lowercase.</p></div>',5),e("table",null,[e("tbody",null,[e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"AUTO_WHITELIST:")])]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"timeout: 1440")]),e("td",null,"# set in minutes how long to keep automatically whitelisted IP")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"after_unblock_timeout: 1440")]),e("td",null,[l(" # set in minutes for how long IP will be added to the "),e("span",{class:"notranslate"},"White List"),l(" after it passes Imunify360 Anti-bot challenge")])]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"DOS:")])]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"enabled: True")]),e("td",null,[l("# allows to enable ("),e("span",{class:"notranslate"},"True"),l(", the default value) or disable ("),e("span",{class:"notranslate"},"False"),l(") DOS detection")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"interval: 30")]),e("td",null,"# interval in seconds between DoS detection system activation")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"default_limit: 250")]),e("td",null,"# maximum default limit of connections from remote IP to local port before DoS protection will be triggered. Cannot be set lower than 100")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"port_limits:")]),e("td",null,"# allows to set limits per local port")]),e("tr",null,[e("td",null,"80: 150 "),e("td",null,"# limit on port 80 is set to 150 connections")]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"ENHANCED_DOS:")])]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"enabled: True")]),e("td",null,[l("# allows to enable or disable ("),e("span",{class:"notranslate"},"False"),l(") the Enhanced DOS protection")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"time_frame: 60")]),e("td",null,"# the default timeframe in seconds between the Enhanced DoS detection system activation")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"default_limit: 500")]),e("td",null,"# the threshold of requests (their number) from remote IP to local port before the Enhanced DoS protection will be triggered.")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"port_limits:")]),e("td",null,"# allows to set requests limits for different ports")]),e("tr",null,[e("td",null,"80: 300 "),e("td",null,"# limit on port 80 is set to 300 connections")]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"FIREWALL:")])]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"port_blocking_mode: ALLOW")]),e("td",null,[l("# allows to set firewall port blocking mode."),e("br"),e("br"),e("b",null,"ALLOW (default)"),l(" - allow all except specified."),e("br"),e("b",null,"DENY"),l(" - block all except specified."),e("br"),e("br"),l(" Exact ports and port-ranges to be allowed can be configured by the following fields in the config file:"),e("br"),l(" - FIREWALL.TCP_IN_IPv4"),e("br"),l(" - FIREWALL.TCP_OUT_IPv4"),e("br"),l(" - FIREWALL.UDP_IN_IPv4"),e("br"),l(" - FIREWALL.UDP_OUT_IPv4"),e("br"),e("br"),l(" - FIREWALL.TCP_IN_IPv6"),e("br"),l(" - FIREWALL.TCP_OUT_IPv6"),e("br"),l(" - FIREWALL.UDP_IN_IPv6"),e("br"),l(" - FIREWALL.UDP_OUT_IPv6"),e("br"),e("br"),l(" Changes of config files will be applied automatically. You don’t need to restart the server or Imunify360."),e("br"),e("br"),e("em",null,[e("b",null,"Please note that CSF needs to be disabled due to conflicts.")])])]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"INCIDENT_LOGGING:")])]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"min_log_level: 4")]),e("td",null,[l("# minimum severity level for incidents displayed in UI. Please find the levels description "),e("a",{href:"/dashboard/#incidents-logging"},"here")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"num_days: 100")]),e("td",null,[l("# incidents older than "),e("span",{class:"notranslate"},[e("em",null,"num_days")]),l(" are automatically deleted")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"limit: 100000")]),e("td",null,"# how many incidents should be stored in Imunify360 log file")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"ui_autorefresh_timeout: 10")]),e("td",null,"# set auto refresh time for incidents in user interface")]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"LOGGER:")])]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"max_log_file_size: 62914560")]),e("td",null,"# defines the maximum size of the log file in bytes (default is 60 MB)")]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"backup_count: 5")]),e("td",null,[l("# defines how many log files to store. If 5, it will store "),e("span",{class:"notranslate"},[e("em",null,"app.log"),l(", "),e("em",null,"app.log.1")]),l(", and up to "),e("span",{class:"notranslate"},[e("em",null,"app.log.5")]),l(".")])]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"syscall_monitor: False")]),e("td",null,[e("p",null,[l("Collect and report the source of suspicious actions using Syscall Monitor ("),e("span",{class:"notranslate"},"True"),l(").")]),l(" Supported operating systems: "),e("ul",null,[e("li",null,"CentOS 6/7"),e("li",null,"CloudLinux OS 6/7.")]),l(" Additional requirements: "),e("ul",null,[e("li",null,[e("b",null,"auditd"),l(" needs to be installed")]),e("li",null,[e("b",null,"auditsp"),l(" needs to be switched off.")])]),e("p",null," Imunify360 uses auditd to discover malicious cron jobs that are not detected by other methods yet and thus block them much faster. "),e("p",null," Additionally, it's also used for internal quality control and monitoring - e.g. if auditd records that PHP processes drop malware, but there are no related events/blocks from Proactive Defense, Imunify team receives an alert prompting an investigation. ")])]),e("tr",null,[e("th",{align:"left"},[e("span",{class:"notranslate"},"MOD_SEC:")]),e("th",{align:"left"},[e("span",{class:"notranslate"},"# defines ModSecurity settings")])]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"ruleset: FULL")]),e("td",null,[l("# defines what ruleset to use: "),e("span",{class:"notranslate"},"FULL"),l(" (default value) or "),e("span",{class:"notranslate"},"MINIMAL"),l(". If the amount of RAM on the server is less than 2.1GB, the ruleset value is automatically set to "),e("span",{class:"notranslate"},"MINIMAL"),l(".")])]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"cms_account_compromise_prevention: False")]),e("td",null,"# enables WordPress account brute-force protection. Default is False.")]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"app_specific_ruleset: True")]),e("td",null,"# enables WAF Rules Auto-Configurator. Default is True.")]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"prev_settings: ")]),e("td",null,"# for internal usage, do not edit")]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"MOD_SEC_BLOCK_BY_SEVERITY:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"enable: True")]),e("td",null,[l("# allows to enable or disable option that moves IPs to "),e("span",{class:"notranslate"},"Gray List"),l(" if the ModSecurity rule is triggered")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"max_incidents: 2")]),e("td",null,[l("# set a number of repeats of the ModSecurity incident from the same IP for adding it to "),e("span",{class:"notranslate"},"Gray List")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"check_period: 120")]),e("td",null,"# set a period in seconds during which incident from the same IP will be recorded as a repeat")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"severity_limit: 2")]),e("td",null,[l("# set a level of severity for DOS detection sensitivity. "),e("a",{href:"/dashboard/#settings"},"Read more"),l(" about severity levels")])]),e("tr",null,[e("th",{align:"left"},[e("span",{class:"notranslate"},"MOD_SEC_BLOCK_BY_CUSTOM_RULE:")]),e("th",{align:"left"},"# this section allows to add custom configuration for blocking by ModSecurity incidents")]),e("tr",null,[e("td",null,"33332:"),e("td",null,"# set ModSecurity rule ID")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"check_period: 120")]),e("td",null,"# set a period in seconds during which incident from the same IP will be recorded as a repeat")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"max_incidents: 10")]),e("td",null,[l("# set a number of repeats of the ModSecurity incident from the same IP for adding it to "),e("span",{class:"notranslate"},"Gray List")])]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"MALWARE_SCANNING:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"try_restore_from_backup_first: False")]),e("td",null,[l("# allows to enable ("),e("span",{class:"notranslate"},"True"),l(") or disable ("),e("span",{class:"notranslate"},"False"),l(" – the default value) automatic malicious file restore from backup if a clean copy exists, otherwise "),e("span",{class:"notranslate"},[e("em",null,"default_action")]),l(" is applied")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"default_action: cleanup")]),e("td",null,[l("# default action on malicious file detected."),e("br"),l(" Available options: "),e("ul",null,[e("li",null,[e("span",{class:"notranslate"},[e("b",null,"notify")]),l(" – just display in dashboard")]),e("li",null,[e("span",{class:"notranslate"},[e("b",null,"cleanup")]),l(" – cleanup malicious file (default)")])])])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"enable_scan_inotify: True")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(" (default)) or disable ("),e("span",{class:"notranslate"},"False"),l(") real-time scanning for modified files using "),e("a",{href:"https://en.wikipedia.org/wiki/Inotify",target:"_blank"},"inotify"),l(" library")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"enable_scan_pure_ftpd: True")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(" (default)) or disable ("),e("span",{class:"notranslate"},"False"),l(") real-time scanning for files uploaded through PureFTPd")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"enable_scan_modsec: True")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(" (default) or disable ("),e("span",{class:"notranslate"},"False"),l(") real-time scanning of all the files that were uploaded via http/https. Note that it requires "),e("a",{href:"https://modsecurity.org",target:"_blank"},"ModSecurity"),l(" to be installed")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"max_signature_size_to_scan: 1048576")]),e("td",null,"# max file size to scan in the standard mode; value is set in bytes")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"max_cloudscan_size_to_scan: 10485760")]),e("td",null,"# max file size to scan in the cloud-assisted (by hashes) mode; value is set in bytes")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"max_mrs_upload_file: 10485760")]),e("td",null,"# max file size to upload to CloudLinux malware research service; value is set in bytes")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"detect_elf: True")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") (default value) or disable ("),e("span",{class:"notranslate"},"False"),l(") binary (ELF) malware detection")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"notify_on_detect: False")]),e("td",null,[l("# notify ("),e("span",{class:"notranslate"},"True"),l(") or not ("),e("span",{class:"notranslate"},"False"),l(") (default value) an admin when malware is detected")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"optimize_realtime_scan: True")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") (default value) or disable ("),e("span",{class:"notranslate"},"False"),l(") the "),e("a",{href:"https://docs.cloudlinux.com/cloudlinux_os_kernel/#file-change-api",target:"_blank"},"File Change API"),l(" and "),e("b",null,"fanotify"),l(" support to reduce the system load while watching for file changes in comparison with inotify watch. You can find the comparison table "),e("a",{href:"/dashboard/#general-2"},"here")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"sends_file_for_analysis: True")]),e("td",null,[l("# send ("),e("span",{class:"notranslate"},"True"),l(") (default value) or not ("),e("span",{class:"notranslate"},"False"),l(") malicious and suspicious files to the Imunify team for analysis")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"i360_clamd: False")]),e("td",null,"# obsolete (not used)")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"show_clamav_results: False")]),e("td",null,"# obsolete (not used)")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"clamav_binary: True")]),e("td",null,"# obsolete (not used)")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"scan_modified_files: Null")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") or disable ("),e("span",{class:"notranslate"},"False"),l(") (default is not set). If disabled, it checks the file's timestamps (c/mtime) before scanning, and if the timestamp is not changed since the last scan, the file is skipped. Scanner's behaviour is based on other scan optimizations, therefore it is better to rely on default values and UI, although this parameter provides an option to overwrite this behaviour. This option is not available within UI.")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"cloud_assisted_scan: True")]),e("td",null,"# speed up scans by check file hashes using cloud database")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"rapid_scan: True")]),e("td",null,[l("# speeds up ("),e("span",{class:"notranslate"},"True"),l(") (default value) ot not ("),e("span",{class:"notranslate"},"False"),l(") repeated scans based on smart re-scan approach, local result caching and cloud-assisted scan.")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"rapid_scan_rescan_unchanging_files_frequency: null")]),e("td",null,'# defines what part of all files will be rescanned during each scan. For example, if set 10 then 1/10 part of all files will be rescanned. The default value `null` - means "choose frequency based on scan schedule". E.g. month - 1, week - 5, day - 10.')]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"hyperscan: True")]),e("td",null,[l("# allows to use ("),e("span",{class:"notranslate"},"True"),l(") the regex matching Hyperscan library in Malware Scanner to greatly improve the scanning speed. "),e("span",{class:"notranslate"},"True"),l(" is the default value. Hyperscan requires its own signatures set that will be downloaded from the files.imunify360.com and compiled locally."),e("br"),e("b",null,"Platform requirements"),l(":"),e("br"),l("* Hyperscan supports Debian, Ubuntu and CentOS/CloudLinux 7 and later."),e("br"),l("* SSE3 processor instructions support. It is quite common nowadays, but may be lacking in virtual environments or in some rather old servers.")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"enable_scan_cpanel: False")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") blocking malicious file uploads via cPanel File Manager. The default value is "),e("span",{class:"notranslate"},"False"),l(". The type of operations processed are: edits and saves")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"crontabs: True")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") scan of the system and user crontab files for malicious jobs. The default value is "),e("span",{class:"notranslate"},"True"),l(".")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"db_timeout: 15")]),e("td",null,"# set the maximum time in seconds for connecting to or reading from a database during a scan/clean/restore operation.")]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"CAPTCHA:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"cert_refresh_timeout: 3600")]),e("td",null,"# set in seconds how often SSL certificate will be refreshed")]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"CONTROL_PANEL:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"compromised_user_password_reset: True")]),e("td",null,[l("# enables resetting passwords for compromised cPanel accounts. Upon activating this functionality, our platform will detect instances where a cPanel account password has been breached and will subsequently prevent access using the previous password. End-users will then be prompted to create a new password via the "),e("a",{href:"https://docs.cpanel.net/knowledge-base/security/how-to-reset-a-cpanel-account-password/",target:"_blank"},"cPanel password reset process"),l(".")])]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"ERROR_REPORTING:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"enable: True")]),e("td",null,"# automatically report errors to imunify360 team")]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"SEND_ADDITIONAL_DATA:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"enable: True")]),e("td",null,"# send anonymized data from query string/post parameters and cookies. True is the default value.")]),e("tr",null,[e("th",{align:"left"},[e("span",{class:"notranslate"},"NETWORK_INTERFACE:")]),e("th",{aligh:"left"},"# manages for what network interfaces Imunify360 rules will be applied")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"eth_device: None")]),e("td",null,[l("# by default, Imunify360 will auto-configure iptables to filter all traffic. If you want iptables rules to be applied to a specific NIC only, list them here (e.g. "),e("span",{class:"notranslate"},"eth1"),l(")")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"eth6_device: None")]),e("td",null,[l("# it is the same as "),e("span",{class:"notranslate"},[e("em",null,"eth_device")]),l(", but configures ip6tables to use specific device")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"eth_device_skip: []")]),e("td",null,[l("# if you don't want iptables\\ip6tables rules to be applied to specific NICs, list them here (e.g "),e("span",{class:"notranslate"},"[eth1, eth2]"),l(")")])]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"BACKUP_RESTORE:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"max_days_in_backup: 90")]),e("td",null,[l("# restore from backup files that are not older than "),e("span",{class:"notranslate"},[e("em",null,"max_days_in_backup")])])]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"CAPTCHA_DOS:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"enabled: True")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(" (default) or disable ("),e("span",{class:"notranslate"},"False"),l(") Anti-bot Challenge Dos protection")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"time_frame: 21600")]),e("td",null,"# set a period in seconds during which requests to Anti-bot Challenge from the same IP will be recorded as repeated")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"max_count: 100")]),e("td",null,"# set the maximum number of repeated Anti-bot Challenge requests after which IP is moved to the Anti-bot Challenge Dos list without an ability to request Anti-bot Challenge again")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"timeout: 864000")]),e("td",null,"# set in seconds the time on which to add the IP in Anti-bot Challenge Dos list without an ability to request Anti-bot Challenge again")]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"BLOCKED_PORTS:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"default_mode: allowed")]),e("td",null,[l("# defines the default state of ports which is not explicitly set by user ("),e("span",{class:"notranslate"},[e("em",null,"denied")]),l(" by default or "),e("span",{class:"notranslate"},[e("em",null,"allowed")]),l(" by default). Currently only "),e("span",{class:"notranslate"},[e("em",null,"allowed")]),l(" is supported")])]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"WEBSHIELD:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"known_proxies_support: True")]),e("td",null,"# enable CDN support, treat IPs behind CDN as any other IPs. (True is the default value).")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"enable: True")]),e("td",null,"# enable (True) (default value) or disable (False) WebShield")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"splash_screen: True")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") or disable ("),e("span",{class:"notranslate"},"False"),l(") Anti-bot protection")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"panel_protection: False")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") or disable ("),e("span",{class:"notranslate"},"False"),l(" – default) "),e("a",{href:"https://docs.imunify360.com/features/#cpanel-account-protection"},"cPanel account protection"),l(" – applies the Anti-Bot JavaScript challenge on cPanel login ports 2082/2083.")])]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"PROACTIVE_DEFENCE:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"blamer: True")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(" (default)) or disable ("),e("span",{class:"notranslate"},"False) Blamer"),l(". See also: "),e("a",{href:"https://blog.imunify360.com/forcibly-enable-blamer",target:"_blank"},"How to forcibly enable Blamer for all users on the server"),l(".")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"mode: LOG")]),e("td",null,[l("# available modes:"),e("ul",null,[e("li",null,[e("span",{class:"notranslate"},"KILL")]),e("li",null,[e("span",{class:"notranslate"},"DISABLED")]),e("li",null,[e("span",{class:"notranslate"},"LOG"),l(" (default)")])])])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"php_immunity: False")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") or disable ("),e("span",{class:"notranslate"},"False (default)) PHP Immunity "),l(" (allows to automatically detect & patch vulnerabilities in software at the Proactive Defense level preventing re-infections through the same vulnerability). By enabling this feature, Blamer will be enabled as well and Proactive Defence switched into the KILL mode.")])]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"MALWARE_SCAN_INTENSITY:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"cpu: 2")]),e("td",null,"# intensity level for CPU consumption. Can be set from 1 to 7, default is 2")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"io: 2")]),e("td",null,"# intensity level for file operations. Can be set from 1 to 7, default is 2")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"ram: 1024")]),e("td",null,"# intensity level for RAM consumption. The default value is 1024")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"user_scan_cpu: 2")]),e("td",null,[l("# intensity level for CPU consumption. Can be set from 1 to 7, default is 2. "),e("br"),e("br"),l("This option is "),e("b",null,"for scans initiated by end-users"),l(". More at "),e("a",{href:"/faq_and_known_issues/#_27-how-to-enable-scan-for-end-users"},"How to enable scan for end-users?"),l(),e("br"),e("br"),e("b",null,"Note:"),l(" The global/admin resource limits ("),e("code",null,"cpu"),l(", "),e("code",null,"io"),l(", "),e("code",null,"ram"),l(" without the "),e("code",null,"user_scan_"),l(" prefix) can also be "),e("a",{href:"/dashboard/#resource-consumption"},"controlled through UI.")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"user_scan_io: 2")]),e("td",null,"# intensity level for file operations for scans initiated by end-users. Can be set from 1 to 7, default is 2")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"user_scan_ram: 1024")]),e("td",null,"# intensity level for RAM consumption for scans initiated by end-users. The default value is 1024")]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"MALWARE_SCAN_SCHEDULE:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"day_of_month: <next day after installation>")]),e("td",null,"# when the background scan shall start, day of the month. Can be from 1 to 31, the default value is the <next day after installation>.")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"day_of_week: 0")]),e("td",null,"# when the background scan shall start, day of the week. Can be from 0 to 7 (0 for Sunday, 1 for Monday..., 7 for Sunday (again)), the default value is 0")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"hour: 3")]),e("td",null,"# when the background scan shall start, hour. Can be from 0 to 23, the default value is 3")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"interval: MONTH")]),e("td",null,[l("# interval of scan. Supported values: strings "),e("span",{class:"notranslate"},"`NONE`"),l(" (no scan), "),e("span",{class:"notranslate"},"`DAY`"),l(", "),e("span",{class:"notranslate"},"`WEEK`"),l(", "),e("span",{class:"notranslate"},"`MONTH`"),l(", the default value is "),e("span",{class:"notranslate"},"`MONTH`")])]),e("tr",null,[e("td",{colspan:"2"},[e("p",null,[e("b",null,"Per-user overrides")]),e("p",null,[l(" You can override "),e("span",{class:"notranslate"},"MALWARE_SCAN_SCHEDULE"),l(),e("b",null,"per user"),l(". Per-user config files are stored at "),e("span",{class:"notranslate"},"/etc/imunify360/user_config/<username>/imunify360.config"),l(" and support the same schema as the admin config for this section. When both admin and user values exist, the user value is used for that option; missing user options inherit the admin value. ")]),e("p",null,[e("b",null,"Example (YAML) of per-user schedule:")]),e("div",{class:"notranslate"},[e("div",{class:"language-text line-numbers-mode","data-ext":"text"},[e("pre",{class:"language-text"},[e("code",null,`MALWARE_SCAN_SCHEDULE:
  interval: week   # allowed: none, day, week, month
  hour: 2          # 0..23
  day_of_week: 1   # 0..7 (0/7 = Sunday)
`)]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])])]),e("p",null,[e("b",null,"CLI examples for per-user:")]),e("div",{class:"notranslate"},[e("div",{class:"language-text line-numbers-mode","data-ext":"text"},[e("pre",{class:"language-text"},[e("code",null,`# Show effective config for a user
imunify360-agent config show --user <username> --json

# Set a weekly scan at 03:00 on Monday for a user
imunify360-agent config update '{"MALWARE_SCAN_SCHEDULE": {"interval": "week", "hour": 3, "day_of_week": 1}}' --user <username>

# Disable scheduled scans for a user
imunify360-agent config update '{"MALWARE_SCAN_SCHEDULE": {"interval": "none"}}' --user <username>
`)]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])])]),e("p",null,[e("b",null,"License notes")]),e("p",null,[l(" Daily/Weekly schedules are available on "),e("b",null,"Imunify360"),l(" and "),e("b",null,"ImunifyAV+"),l(". On "),e("b",null,"ImunifyAV"),l(", only "),e("span",{class:"notranslate"},"none"),l(" and "),e("span",{class:"notranslate"},"month"),l(" intervals are available. If a non-eligible interval is configured, the agent will ignore it and keep the schedule at a safe default. ")])])]),e("tr",null,[e("th",{align:"left"},[e("span",{class:"notranslate"},"PAM:")]),e("th",{align:"left"},"# effective way to prevent brute-force attacks against FTP/SSH")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"enable: False")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") or disable ("),e("span",{class:"notranslate"},"False"),l(") (default value) PAM brute-force attack protection")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"exim_dovecot_protection: False")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") or disable ("),e("span",{class:"notranslate"},"False"),l(") (default value) Exim+Dovecot brute-force attack protection against Dovecot brute-force attacks.")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"ftp_protection: False")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") or disable ("),e("span",{class:"notranslate"},"False"),l(") (default value) FTP brute-force attack protection.")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"exim_dovecot_native: True")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") (default value) or disable ("),e("span",{class:"notranslate"},"False"),l(") the Dovecot native module.")])]),e("tr",null,[e("th",{align:"left"},[e("span",{class:"notranslate"},"KERNELCARE:"),l(" ("),e("b",null,[e("font",{color:"Red"},"deprecated")]),l(")")]),e("th",{align:"left"},"# KernelCare extension for Imunify360 which allows tracing malicious invocations to detect privilege escalation attempts")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"edf: False"),l(" ("),e("b",null,[e("font",{color:"Red"},"deprecated")]),l(")")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") or disable ("),e("span",{class:"notranslate"},"False"),l(") (default value) exploit detection framework")])]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"MALWARE_CLEANUP:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"trim_file_instead_of_removal: True")]),e("td",null,[l("# do not remove infected file during cleanup but make the file zero-size (for malwares like web-shells) ("),e("span",{class:"notranslate"},"True"),l(") (default value)")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"keep_original_files_days: 14")]),e("td",null,"# the original infected file is available for restore within the defined period. The default is 14 days. The minimum value is one day.")]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"OSSEC:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"active_response: False")]),e("td",null,[l("# block ("),e("span",{class:"notranslate"},"True"),l(") access to a specific server port being attacked. The ports include FTP (21), SSH (any port) and SMTP (25, 465, 587). The default value is "),e("span",{class:"notranslate"},"False"),l(".")])]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"ADMIN_CONTACTS:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"emails: youremail@email.com")]),e("td",null,"# your email to receive reports about critical issues, security alerts or system misconfigurations detected on your servers.")]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"SMTP_BLOCKING:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"enable: False")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") or disable ("),e("span",{class:"notranslate"},"False"),l(") (default value) SMTP Traffic Management. When enabled, the outgoing SMTP traffic would be blocked according to the settings.")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"ports: 25,587,465")]),e("td",null,"# a list of the ports to be blocked. The defaults are: 25, 587,465.")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"allow_users:")]),e("td",null,"# a list of users to be ignored (not blocked). By default it is empty. Including Unix and cPanel users (if a process that sends an email has a UID of one of the `allow_users`, it will not be blocked).")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"allow_groups: mail")]),e("td",null,"# a list of the groups to be ignored (not blocked). By default it is empty. Including Unix and cPanel users (if a process that sends an email has a UID of one of the `allow_users`, it will not be blocked).")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"allow_local: False")]),e("td",null,[l("# block ("),e("span",{class:"notranslate"},"True"),l(") all, except the local SMTP (localhost). "),e("span",{class:"notranslate"},"False"),l(" is the default value.")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"redirect: False")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") or disable ("),e("span",{class:"notranslate"},"False"),l(") (the default value) automatic redirection to the local ports for outgoing mail traffic.")])]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"CSF_INTEGRATION:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"catch_lfd_events: False")]),e("td",null,[l("# let ("),e("span",{class:"notranslate"},"True"),l(") Imunify360 use Login Failure Daemon (LFD) as a source for security events. Default is False.")])]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"PERMISSIONS:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"support_form: True")]),e("td",null,[l("# show ("),e("span",{class:"notranslate"},"True"),l(") (the default value) or hide ("),e("span",{class:"notranslate"},"False"),l(") the Support icon in the Imunify360 UI.")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"user_ignore_list: True")]),e("td",null,[l("# show ("),e("span",{class:"notranslate"},"True"),l(") (the default value) or hide ("),e("span",{class:"notranslate"},"False"),l(") the Ignore List tab for end-users in the Imunify360 UI.")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"allow_malware_scan: False")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") or disable ("),e("span",{class:"notranslate"},"False"),l(") (the default value) “scan” action in the UI of the end-user.")])]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"advisor: True")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(" - the default value) or disable ("),e("span",{class:"notranslate"},"False"),l(") the Imunify Advisor.")])]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"user_override_malware_actions: False")]),e("td",null,[l("# "),e("span",{class:"notranslate"},'"True"'),l(" allows overriding of actions applied to malware by a regular user. E.g., users will be able to disable automatic cleanup for their own files even if it was enabled by the admin.")])]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"user_override_proactive_defense: False")]),e("td",null,[l("# "),e("span",{class:"notranslate"},'"True"'),l(" allows overriding of Proactive Defense work mode by a regular user. E.g., users will be able to switch Proactive Defense mode to "),e("span",{class:"notranslate"},"LOG"),l(" for their websites even if the admin has set it to "),e("span",{class:"notranslate"},"KILL"),l(".")])]),e("tr",null,[e("td",{width:"250px;"},[e("span",{class:"notranslate"},"allow_local_rules_management: True")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(" - the default value) or disable ("),e("span",{class:"notranslate"},"False"),l(") managing the "),e("a",{href:"/dashboard/#disabled-rules"},"Disabled Rules"),l(" in the Imunify360 UI.")])]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"STOP_MANAGING:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"modsec_directives: False")]),e("td",null,"# for internal usage, do not edit")]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"WEB_SERVICES:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"http_ports: ")]),e("td",null,"# additional http ports for Anti-bot Challenge")]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"https_ports: ")]),e("td",null,"# additional https ports for Anti-bot Challenge")]),e("tr",null,[e("th",{colspan:"2",align:"left"},[e("span",{class:"notranslate"},"MALWARE_DATABASE_SCAN:")])]),e("tr",null,[e("td",null,[e("span",{class:"notranslate"},"enable: True")]),e("td",null,[l("# enable ("),e("span",{class:"notranslate"},"True"),l(") the Malware Database Scanner - a database antivirus with automated malware detection and clean-up of web applications. Requires MariaDB/MySQL DB management system version 5.5. Recommended version is 5.6+. Note, that only WordPress, Joomla, and Magento databases are supported now.")])])])],-1),n(`<p><span class="notranslate">Active Response</span> is an ossec-driven (IDS) feature of Imunify360 which has been re-engineered to make it capable of blocking access to a specific server port being attacked.</p><p>The purpose of the feature is significantly reducing false positive rate while increasing its capabilities to detect and block aggressive brute force requests.</p><p>In order to activate <span class="notranslate">Active Response, </span>the following lines should be added into <span class="notranslate"><em>/etc/sysconfig/imunify360/imunify360.config</em></span>:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>OSSEC:
  active_response: True
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div> and then restart Imunify360 service: <div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>systemctl restart imunify360
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><h4 id="how-to-apply-changes-from-cli" tabindex="-1"><a class="header-anchor" href="#how-to-apply-changes-from-cli" aria-hidden="true">#</a> How to apply changes from CLI</h4><p>In order to apply changes via command-line interface (CLI), you can use the following command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;SECTION&quot;: {&quot;parameter&quot;: value}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>For example, if you want to set <span class="notranslate"><code>MALWARE_SCAN_INTENSITY.cpu = 5</code></span> from a command line, then you should execute the following command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;MALWARE_SCAN_INTENSITY&quot;: {&quot;cpu&quot;: 5}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>It is also possible to apply several parameters at once. For example:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;PAM&quot;: {&quot;exim_dovecot_protection&quot;: false, &quot;enable&quot;:true}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>For string configuration values, such as the administrator&#39;s email address, it is necessary to use the following command format:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;ADMIN_CONTACTS&quot;: {&quot;emails&quot;: [&quot;email@domain.com&quot;]}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div>`,15)]))}const c=t(r,[["render",i],["__file","index.html.vue"]]);export{c as default};
